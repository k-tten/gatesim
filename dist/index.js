/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/Component.ts":(e,t,s)=>{s.r(t),s.d(t,{Component:()=>o});var n=s("./src/Reified.ts"),i=s("./src/WiringManager.ts");class o extends n.Reified{element;inputs=[];outputs=[];#e=new Map;#t=new Map;chip;constructor(e,{x:t,y:s}={x:0,y:0}){super(),this.chip=e,this.element=n.html`
            <div class="component">
                <div class="component-inputs">
                    ${Array(this.chip.inputs).fill('<button class="component-input-button">I</button>').join("")}
                </div>
                <p class="component-name">${this.chip.name}</p>
                <div class="component-outputs">
                    ${Array(this.chip.outputs).fill('<button class="component-output-button">O</button>').join("")}
                </div>
            </div>
        `,this.inputs=Array.from(this.element.querySelectorAll(".component-input-button")),this.outputs=Array.from(this.element.querySelectorAll(".component-output-button")),this.inputs.forEach((e=>{this.#e.set(e,new MutationObserver((()=>{const e=this.chip.evaluate(this.inputs.map((e=>e.classList.contains("activated"))));this.outputs.forEach(((t,s)=>{t.classList.toggle("activated",e[s])}))}))),this.#t.set(e,(t=>{t.preventDefault(),t.stopImmediatePropagation();const s=i.WiringManager.wires.findIndex((t=>t.to===e));s>=0&&i.WiringManager.wires.splice(s,1)}))})),this.move(t,s)}attach(){super.attach(),this.inputs.forEach((e=>{this.#e.get(e).observe(e,{attributeFilter:["class"],attributes:!0}),e.addEventListener("contextmenu",this.#t.get(e))}))}detach(){super.detach(),this.#e.forEach((e=>e.disconnect())),this.#t.forEach(((e,t)=>t.removeEventListener("contextmenu",e)))}}},"./src/DraggingManager.ts":(e,t,s)=>{s.r(t),s.d(t,{DraggingManager:()=>n});class n{static#s=void 0;static#n={x:-1,y:-1,ox:-1,oy:-1,down:!1};static#i=new Map;static watch(e,t=e){e.dataset.watched="true";const s=t=>{this.#s=e,this.#s.dataset.dragged="true",this.#s.style.cursor="grabbing";const s=this.#s.getBoundingClientRect(),n=this.#s.parentElement?.getBoundingClientRect()??new DOMRect;this.#n.ox=t.clientX-s.left+n.left,this.#n.oy=t.clientY-s.top+n.top};t.addEventListener("mousedown",s,{capture:!0}),this.#i.set(t,s)}static forget(e){const t=this.#i.get(e);if(!t)throw new Error("Element is not currently being watched.");delete e.dataset.watched,e.removeEventListener("mousedown",t,{capture:!0}),this.#i.delete(e)}static listen(){document.body.addEventListener("mousemove",this.#o),window.addEventListener("mousedown",this.#r),window.addEventListener("mouseup",this.#a)}static deafen(){document.body.removeEventListener("mousemove",this.#o),window.removeEventListener("mousedown",this.#r),window.removeEventListener("mouseup",this.#a)}static#o=e=>{this.#n.x=e.clientX,this.#n.y=e.clientY,this.#s&&(this.#s.style.left=this.#n.x-this.#n.ox+"px",this.#s.style.top=this.#n.y-this.#n.oy+"px")};static#r=e=>{this.#n.down=!0};static#a=()=>{this.#s&&document.querySelectorAll('[data-dragged="true"]').forEach((e=>{delete e.dataset.dragged,e.style.cursor=""})),this.#n.down=!1,this.#n.x=-1,this.#n.y=-1,this.#n.ox=-1,this.#n.oy=-1,this.#s=void 0}}},"./src/Input.ts":(e,t,s)=>{s.r(t),s.d(t,{Input:()=>i});var n=s("./src/Reified.ts");class i extends n.Reified{element;constructor({x:e,y:t}={x:0,y:0}){super(),this.element=n.html`<button class="board-input">I</button>`,this.move(e,t)}#c=()=>{this.element.classList.toggle("activated")};#u=e=>{e.preventDefault(),this.element.classList.toggle("activated")};attach(){super.attach(),this.element.addEventListener("click",this.#c),this.element.addEventListener("contextmenu",this.#u)}detach(){super.detach(),this.element.removeEventListener("click",this.#c),this.element.removeEventListener("contextmenu",this.#u)}}},"./src/MenuManager.ts":(e,t,s)=>{s.r(t),s.d(t,{MenuManager:()=>i});var n=s("./src/Reified.ts");class i{static#l=new Map;static use(e,t){const s=n.html`
            <div class="contextmenu">
                ${t.map((e=>Object.entries(e).map((([e,{label:t}])=>`<button class="${e}">${t}</button>`)).join(""))).join('<div class="br"></div>')}
            </div>
        `,i=new Map;t.forEach((e=>{Object.keys(e).forEach((t=>{s.querySelector("."+t).addEventListener("click",(()=>{e[t].callback.call(void 0)})),i.set(t,i)}))})),s.style.left="0px",s.style.top="0px",s.style.display="none",document.body.appendChild(s);const o=()=>{s.style.left="0px",s.style.top="0px",s.style.display="none"},r=e=>{e.preventDefault(),s.style.display="",s.style.left=e.clientX+"px",s.style.top=e.clientY+"px"},a=()=>{s.style.left="0px",s.style.top="0px",s.style.display="none"};e.addEventListener("mousedown",o),e.addEventListener("contextmenu",r),s.addEventListener("click",a),this.#l.set(e,{menu:s,clicks:i,listeners:{mousedown:o,contextmenu:r,click:a}})}static remove(e){const{menu:t,clicks:s,listeners:n}=this.#l.get(e)??{};if(!t||!s||!n)throw new Error("Elements are not being affected.");e.removeEventListener("mousedown",n.mousedown),e.removeEventListener("contextmenu",n.contextmenu),t.removeEventListener("click",n.click),Array.from(s).forEach((([e,s])=>t.querySelector("."+e).removeEventListener("click",s))),t.remove()}}},"./src/Output.ts":(e,t,s)=>{s.r(t),s.d(t,{Output:()=>o});var n=s("./src/Reified.ts"),i=s("./src/WiringManager.ts");class o extends n.Reified{element;#u=e=>{e.preventDefault(),e.stopImmediatePropagation();const t=i.WiringManager.wires.findIndex((e=>e.to===this.element));t>=0&&i.WiringManager.wires.splice(t,1)};constructor({x:e,y:t}={x:0,y:0}){super(),this.element=n.html`<button class="board-output">O</button>`,this.move(e,t)}attach(){super.attach(),this.element.addEventListener("contextmenu",this.#u)}detach(){super.detach(),this.element.removeEventListener("contextmenu",this.#u)}}},"./src/Reified.ts":(e,t,s)=>{function n(...e){const[t,...s]=e,n="string"==typeof t?t:t.reduce(((e,t,n)=>e+t+s[n]??""),"");return(new DOMParser).parseFromString(n,"text/html").body.childNodes[0]}s.r(t),s.d(t,{Reified:()=>i,html:()=>n});class i{static root=document.querySelector(".reified-root");move(e,t){this.element.style.left=e+"px",this.element.style.top=t+"px"}attach(){i.root.append(this.element)}detach(){this.element.remove()}}},"./src/WiringManager.ts":(e,t,s)=>{s.r(t),s.d(t,{Wiring:()=>i,WiringManager:()=>o});var n=s("./src/canvas.ts");class i{from;to;constructor(e,t){this.from=e,this.to=t,new MutationObserver((()=>{t.classList.toggle("activated",e.classList.contains("activated"))})).observe(e,{attributeFilter:["class"],attributes:!0})}}class o{static wires=[];static render(){const e=(0,n.useCanvas)();this.wires.forEach((t=>{const s=t.from.getBoundingClientRect(),n=t.to.getBoundingClientRect();e.strokeStyle=t.from.classList.contains("activated")?"#ff2626":"#dedede",e.lineWidth=5,e.lineJoin="round",e.beginPath(),e.moveTo(s.x+s.width/2,s.y+s.height/2),e.lineTo(n.x+n.width/2,n.y+n.height/2),e.closePath(),e.stroke()}))}}},"./src/canvas.ts":(e,t,s)=>{s.r(t),s.d(t,{useCanvas:()=>i});const n=document.querySelector("canvas").getContext("2d");function i(){return n.canvas.width=window.innerWidth,n.canvas.height=window.innerHeight,n}},"./src/chips.ts":(e,t,s)=>{s.r(t),s.d(t,{AndGate:()=>i,Chip:()=>n,NotGate:()=>r,OrGate:()=>o});class n{name;inputs;outputs;constructor(e,t,s){this.name=e,this.inputs=t,this.outputs=s}evaluate(e){return this.output(e)}}class i extends n{constructor(){super("AND",2,1)}output([e,t]){return[e&&t]}}class o extends n{constructor(){super("OR",2,1)}output([e,t]){return[e||t]}}class r extends n{constructor(){super("NOT",1,1)}output([e]){return[!e]}}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,s),o.exports}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{s.r(n);var e=s("./src/chips.ts"),t=s("./src/Component.ts"),i=s("./src/DraggingManager.ts"),o=s("./src/Input.ts"),r=s("./src/MenuManager.ts"),a=s("./src/Output.ts"),c=s("./src/Reified.ts"),u=s("./src/WiringManager.ts");const l=new o.Input({x:100,y:100}),d=new o.Input({x:100,y:200}),m=new t.Component(new e.AndGate,{x:300,y:150}),h=new a.Output({x:500,y:150}),p=new Set([l,d,m,h]);i.DraggingManager.listen(),p.forEach((e=>{e.attach(),e instanceof t.Component&&i.DraggingManager.watch(e.element,e.element.querySelector(".component-name"))})),u.WiringManager.wires.push(new u.Wiring(l.element,m.inputs[0])),u.WiringManager.wires.push(new u.Wiring(d.element,m.inputs[1])),u.WiringManager.wires.push(new u.Wiring(m.outputs[0],h.element)),r.MenuManager.use(c.Reified.root,[{"insert-chip":{label:"Insert chip",callback:()=>{}}},{"new-input":{label:"New input",callback:()=>{}},"new-output":{label:"New output",callback:()=>{}}},{"new-chip":{label:"New chip from diagram",callback:()=>{}}},{"save-as":{label:"Save as file",callback:()=>{}}}]),function e(){u.WiringManager.render(),requestAnimationFrame(e)}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q1BLLFNBQVUsV0FLdEIsU0FBVW1FLElBQ04sRUFBQTFILGNBQUEsU0FFQTJILHNCQUFzQkQsRUFDekIsQ0FKRCIsInNvdXJjZXMiOlsid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9Db21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL0RyYWdnaW5nTWFuYWdlci50cyIsIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vLi9zcmMvSW5wdXQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL01lbnVNYW5hZ2VyLnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9PdXRwdXQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL1JlaWZpZWQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL1dpcmluZ01hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vLi9zcmMvY2hpcHMudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltL3dlYnBhY2svcnVudGltZS9tYWtlIG5hbWVzcGFjZSBvYmplY3QiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENoaXAgfSBmcm9tIFwiLi9jaGlwc1wiO1xuaW1wb3J0IHsgaHRtbCwgUmVpZmllZCB9IGZyb20gXCIuL1JlaWZpZWRcIjtcbmltcG9ydCB7IFdpcmluZ01hbmFnZXIgfSBmcm9tIFwiLi9XaXJpbmdNYW5hZ2VyXCI7XG5cbmV4cG9ydCBjbGFzcyBDb21wb25lbnQ8SSBleHRlbmRzIG51bWJlciwgTyBleHRlbmRzIG51bWJlcj4gZXh0ZW5kcyBSZWlmaWVkIHtcbiAgICByZWFkb25seSBlbGVtZW50O1xuXG4gICAgcmVhZG9ubHkgaW5wdXRzID0gW10gYXMgSFRNTEJ1dHRvbkVsZW1lbnRbXTtcbiAgICByZWFkb25seSBvdXRwdXRzID0gW10gYXMgSFRNTEJ1dHRvbkVsZW1lbnRbXTtcblxuICAgIHJlYWRvbmx5ICNvYnNlcnZlcnMgPSBuZXcgTWFwKCk7XG4gICAgcmVhZG9ubHkgI2NvbnRleHRtZW51cyA9IG5ldyBNYXAoKTtcblxuICAgIHJlYWRvbmx5IGNoaXA6IENoaXA8SSwgTz47XG5cbiAgICBjb25zdHJ1Y3RvcihjaGlwOiBDaGlwPEksIE8+LCB7IHgsIHkgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9ID0geyB4OiAwLCB5OiAwIH0pIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLmNoaXAgPSBjaGlwO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudCA9IGh0bWxgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tcG9uZW50XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbXBvbmVudC1pbnB1dHNcIj5cbiAgICAgICAgICAgICAgICAgICAgJHtBcnJheSh0aGlzLmNoaXAuaW5wdXRzKS5maWxsKCc8YnV0dG9uIGNsYXNzPVwiY29tcG9uZW50LWlucHV0LWJ1dHRvblwiPkk8L2J1dHRvbj4nKS5qb2luKFwiXCIpfVxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxwIGNsYXNzPVwiY29tcG9uZW50LW5hbWVcIj4ke3RoaXMuY2hpcC5uYW1lfTwvcD5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tcG9uZW50LW91dHB1dHNcIj5cbiAgICAgICAgICAgICAgICAgICAgJHtBcnJheSh0aGlzLmNoaXAub3V0cHV0cykuZmlsbCgnPGJ1dHRvbiBjbGFzcz1cImNvbXBvbmVudC1vdXRwdXQtYnV0dG9uXCI+TzwvYnV0dG9uPicpLmpvaW4oXCJcIil9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICB0aGlzLmlucHV0cyA9IEFycmF5LmZyb20odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29tcG9uZW50LWlucHV0LWJ1dHRvblwiKSk7XG4gICAgICAgIHRoaXMub3V0cHV0cyA9IEFycmF5LmZyb20odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuY29tcG9uZW50LW91dHB1dC1idXR0b25cIikpO1xuXG4gICAgICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLiNvYnNlcnZlcnMuc2V0KFxuICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICAgIG5ldyBNdXRhdGlvbk9ic2VydmVyKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb3V0ID0gdGhpcy5jaGlwLmV2YWx1YXRlKHRoaXMuaW5wdXRzLm1hcCgoaSkgPT4gaS5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmF0ZWRcIikpKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLm91dHB1dHMuZm9yRWFjaCgob3V0cHV0LCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2YXRlZFwiLCBvdXRbaV0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgdGhpcy4jY29udGV4dG1lbnVzLnNldChpbnB1dCwgKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSBXaXJpbmdNYW5hZ2VyLndpcmVzLmZpbmRJbmRleCgodykgPT4gdy50byA9PT0gaW5wdXQpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGluZGV4ID49IDApIFdpcmluZ01hbmFnZXIud2lyZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm1vdmUoeCwgeSk7XG4gICAgfVxuXG4gICAgYXR0YWNoKCkge1xuICAgICAgICBzdXBlci5hdHRhY2goKTtcblxuICAgICAgICB0aGlzLmlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy4jb2JzZXJ2ZXJzLmdldChpbnB1dCkub2JzZXJ2ZShpbnB1dCwge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUZpbHRlcjogW1wiY2xhc3NcIl0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgdGhpcy4jY29udGV4dG1lbnVzLmdldChpbnB1dCkpO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHN1cGVyLmRldGFjaCgpO1xuXG4gICAgICAgIHRoaXMuI29ic2VydmVycy5mb3JFYWNoKChvKSA9PiBvLmRpc2Nvbm5lY3QoKSk7XG5cbiAgICAgICAgdGhpcy4jY29udGV4dG1lbnVzLmZvckVhY2goKGwsIGlucHV0KSA9PiBpbnB1dC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgbCkpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBEcmFnZ2luZ01hbmFnZXIge1xuICAgIHN0YXRpYyAjZHJhZ2dlZCA9IHVuZGVmaW5lZCBhcyBIVE1MRWxlbWVudCB8IHVuZGVmaW5lZDtcblxuICAgIHN0YXRpYyByZWFkb25seSAjbW91c2UgPSB7XG4gICAgICAgIHg6IC0xLFxuICAgICAgICB5OiAtMSxcbiAgICAgICAgb3g6IC0xLFxuICAgICAgICBveTogLTEsXG4gICAgICAgIGRvd246IGZhbHNlLFxuICAgIH07XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgI3dhdGNoZWQgPSBuZXcgTWFwKCk7XG5cbiAgICBzdGF0aWMgd2F0Y2goZWxlbWVudDogSFRNTEVsZW1lbnQsIHRhcmdldCA9IGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5kYXRhc2V0LndhdGNoZWQgPSBcInRydWVcIjtcblxuICAgICAgICBjb25zdCBtb3VzZWRvd24gPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy4jZHJhZ2dlZCA9IGVsZW1lbnQ7XG5cbiAgICAgICAgICAgIHRoaXMuI2RyYWdnZWQuZGF0YXNldC5kcmFnZ2VkID0gXCJ0cnVlXCI7XG5cbiAgICAgICAgICAgIHRoaXMuI2RyYWdnZWQuc3R5bGUuY3Vyc29yID0gXCJncmFiYmluZ1wiO1xuXG4gICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy4jZHJhZ2dlZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAgICAgY29uc3QgYm9keSA9IHRoaXMuI2RyYWdnZWQucGFyZW50RWxlbWVudD8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgPz8gbmV3IERPTVJlY3QoKTtcblxuICAgICAgICAgICAgdGhpcy4jbW91c2Uub3ggPSBlLmNsaWVudFggLSByZWN0LmxlZnQgKyBib2R5LmxlZnQ7XG4gICAgICAgICAgICB0aGlzLiNtb3VzZS5veSA9IGUuY2xpZW50WSAtIHJlY3QudG9wICsgYm9keS50b3A7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgbW91c2Vkb3duLCB7IGNhcHR1cmU6IHRydWUgfSk7XG5cbiAgICAgICAgdGhpcy4jd2F0Y2hlZC5zZXQodGFyZ2V0LCBtb3VzZWRvd24pO1xuICAgIH1cblxuICAgIHN0YXRpYyBmb3JnZXQoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgbGlzdGVuZXIgPSB0aGlzLiN3YXRjaGVkLmdldChlbGVtZW50KTtcblxuICAgICAgICBpZiAoIWxpc3RlbmVyKSB0aHJvdyBuZXcgRXJyb3IoYEVsZW1lbnQgaXMgbm90IGN1cnJlbnRseSBiZWluZyB3YXRjaGVkLmApO1xuXG4gICAgICAgIGRlbGV0ZSBlbGVtZW50LmRhdGFzZXQud2F0Y2hlZDtcblxuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgbGlzdGVuZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcblxuICAgICAgICB0aGlzLiN3YXRjaGVkLmRlbGV0ZShlbGVtZW50KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgbGlzdGVuKCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy4jbW91c2Vtb3ZlKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy4jbW91c2Vkb3duKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuI21vdXNldXApO1xuICAgIH1cblxuICAgIHN0YXRpYyBkZWFmZW4oKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLiNtb3VzZW1vdmUpO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLiNtb3VzZWRvd24pO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy4jbW91c2V1cCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHJlYWRvbmx5ICNtb3VzZW1vdmUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICB0aGlzLiNtb3VzZS54ID0gZS5jbGllbnRYO1xuICAgICAgICB0aGlzLiNtb3VzZS55ID0gZS5jbGllbnRZO1xuXG4gICAgICAgIGlmICh0aGlzLiNkcmFnZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLiNkcmFnZ2VkLnN0eWxlLmxlZnQgPSB0aGlzLiNtb3VzZS54IC0gdGhpcy4jbW91c2Uub3ggKyBcInB4XCI7XG4gICAgICAgICAgICB0aGlzLiNkcmFnZ2VkLnN0eWxlLnRvcCA9IHRoaXMuI21vdXNlLnkgLSB0aGlzLiNtb3VzZS5veSArIFwicHhcIjtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgI21vdXNlZG93biA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXMuI21vdXNlLmRvd24gPSB0cnVlO1xuICAgIH07XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgI21vdXNldXAgPSAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLiNkcmFnZ2VkKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxFbGVtZW50PignW2RhdGEtZHJhZ2dlZD1cInRydWVcIl0nKS5mb3JFYWNoKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGUuZGF0YXNldC5kcmFnZ2VkO1xuXG4gICAgICAgICAgICAgICAgZS5zdHlsZS5jdXJzb3IgPSBcIlwiO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLiNtb3VzZS5kb3duID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy4jbW91c2UueCA9IC0xO1xuICAgICAgICB0aGlzLiNtb3VzZS55ID0gLTE7XG5cbiAgICAgICAgdGhpcy4jbW91c2Uub3ggPSAtMTtcbiAgICAgICAgdGhpcy4jbW91c2Uub3kgPSAtMTtcblxuICAgICAgICB0aGlzLiNkcmFnZ2VkID0gdW5kZWZpbmVkO1xuICAgIH07XG59XG4iLCJpbXBvcnQgeyBodG1sLCBSZWlmaWVkIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuXG5leHBvcnQgY2xhc3MgSW5wdXQgZXh0ZW5kcyBSZWlmaWVkIHtcbiAgICByZWFkb25seSBlbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoeyB4LCB5IH06IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSA9IHsgeDogMCwgeTogMCB9KSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaHRtbGA8YnV0dG9uIGNsYXNzPVwiYm9hcmQtaW5wdXRcIj5JPC9idXR0b24+YDtcblxuICAgICAgICB0aGlzLm1vdmUoeCwgeSk7XG4gICAgfVxuXG4gICAgcmVhZG9ubHkgI2NsaWNrID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2YXRlZFwiKTtcbiAgICB9O1xuXG4gICAgcmVhZG9ubHkgI2NvbnRleHRtZW51ID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZhdGVkXCIpO1xuICAgIH07XG5cbiAgICBhdHRhY2goKSB7XG4gICAgICAgIHN1cGVyLmF0dGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy4jY2xpY2spO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHN1cGVyLmRldGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy4jY2xpY2spO1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBodG1sIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuXG5leHBvcnQgdHlwZSBNZW51TWFuYWdlckNvbnRleHQgPSB7XG4gICAgbWVudTogSFRNTEVsZW1lbnQ7XG4gICAgY2xpY2tzOiBNYXA8c3RyaW5nLCAoKSA9PiB2b2lkPjtcbiAgICBsaXN0ZW5lcnM6IHtcbiAgICAgICAgbW91c2Vkb3duOiAoZTogTW91c2VFdmVudCkgPT4gdm9pZDtcbiAgICAgICAgY29udGV4dG1lbnU6IChlOiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuICAgICAgICBjbGljazogKGU6IE1vdXNlRXZlbnQpID0+IHZvaWQ7XG4gICAgfTtcbn07XG5cbmV4cG9ydCBjbGFzcyBNZW51TWFuYWdlciB7XG4gICAgc3RhdGljIHJlYWRvbmx5ICNlbGVtZW50cyA9IG5ldyBNYXA8SFRNTEVsZW1lbnQsIE1lbnVNYW5hZ2VyQ29udGV4dD4oKTtcblxuICAgIHN0YXRpYyB1c2UoZWxlbWVudDogSFRNTEVsZW1lbnQsIGFjdGlvbnM6IFJlY29yZDxzdHJpbmcsIHsgbGFiZWw6IHN0cmluZzsgY2FsbGJhY2s6ICgpID0+IHZvaWQgfT5bXSkge1xuICAgICAgICBjb25zdCBtZW51ID0gaHRtbGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb250ZXh0bWVudVwiPlxuICAgICAgICAgICAgICAgICR7YWN0aW9uc1xuICAgICAgICAgICAgICAgICAgICAubWFwKChyZWNvcmQpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuZW50cmllcyhyZWNvcmQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgoW25hbWUsIHsgbGFiZWwgfV0pID0+IGA8YnV0dG9uIGNsYXNzPVwiJHtuYW1lfVwiPiR7bGFiZWx9PC9idXR0b24+YClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAuam9pbihcIlwiKVxuICAgICAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgICAgICAgIC5qb2luKCc8ZGl2IGNsYXNzPVwiYnJcIj48L2Rpdj4nKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuXG4gICAgICAgIGNvbnN0IGNsaWNrcyA9IG5ldyBNYXAoKTtcblxuICAgICAgICBhY3Rpb25zLmZvckVhY2goKHJlY29yZCkgPT4ge1xuICAgICAgICAgICAgT2JqZWN0LmtleXMocmVjb3JkKS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmVjb3JkW2tleV0uY2FsbGJhY2suY2FsbCh1bmRlZmluZWQpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBtZW51LnF1ZXJ5U2VsZWN0b3I8SFRNTEVsZW1lbnQ+KFwiLlwiICsga2V5KSEuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrKTtcblxuICAgICAgICAgICAgICAgIGNsaWNrcy5zZXQoa2V5LCBjbGlja3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1lbnUuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgICAgIG1lbnUuc3R5bGUudG9wID0gXCIwcHhcIjtcbiAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtZW51KTtcblxuICAgICAgICBjb25zdCBtb3VzZWRvd24gPSAoKSA9PiB7XG4gICAgICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY29udGV4dG1lbnUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBtZW51LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5sZWZ0ID0gZS5jbGllbnRYICsgXCJweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBlLmNsaWVudFkgKyBcInB4XCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vdXNlZG93bik7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGNvbnRleHRtZW51KTtcbiAgICAgICAgbWVudS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2spO1xuXG4gICAgICAgIHRoaXMuI2VsZW1lbnRzLnNldChlbGVtZW50LCB7IG1lbnUsIGNsaWNrcywgbGlzdGVuZXJzOiB7IG1vdXNlZG93biwgY29udGV4dG1lbnUsIGNsaWNrIH0gfSk7XG4gICAgfVxuXG4gICAgc3RhdGljIHJlbW92ZShlbGVtZW50OiBIVE1MRWxlbWVudCkge1xuICAgICAgICBjb25zdCB7IG1lbnUsIGNsaWNrcywgbGlzdGVuZXJzIH0gPSB0aGlzLiNlbGVtZW50cy5nZXQoZWxlbWVudCkgPz8ge307XG5cbiAgICAgICAgaWYgKCFtZW51IHx8ICFjbGlja3MgfHwgIWxpc3RlbmVycykgdGhyb3cgbmV3IEVycm9yKGBFbGVtZW50cyBhcmUgbm90IGJlaW5nIGFmZmVjdGVkLmApO1xuXG4gICAgICAgIGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBsaXN0ZW5lcnMubW91c2Vkb3duKTtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgbGlzdGVuZXJzLmNvbnRleHRtZW51KTtcbiAgICAgICAgbWVudS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgbGlzdGVuZXJzLmNsaWNrKTtcblxuICAgICAgICBBcnJheS5mcm9tKGNsaWNrcykuZm9yRWFjaCgoW2tleSwgbGlzdGVuZXJdKSA9PlxuICAgICAgICAgICAgbWVudS5xdWVyeVNlbGVjdG9yKFwiLlwiICsga2V5KSEucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGxpc3RlbmVyKVxuICAgICAgICApO1xuXG4gICAgICAgIG1lbnUucmVtb3ZlKCk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgaHRtbCwgUmVpZmllZCB9IGZyb20gXCIuL1JlaWZpZWRcIjtcbmltcG9ydCB7IFdpcmluZ01hbmFnZXIgfSBmcm9tIFwiLi9XaXJpbmdNYW5hZ2VyXCI7XG5cbmV4cG9ydCBjbGFzcyBPdXRwdXQgZXh0ZW5kcyBSZWlmaWVkIHtcbiAgICByZWFkb25seSBlbGVtZW50O1xuXG4gICAgcmVhZG9ubHkgI2NvbnRleHRtZW51ID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgY29uc3QgaW5kZXggPSBXaXJpbmdNYW5hZ2VyLndpcmVzLmZpbmRJbmRleCgodykgPT4gdy50byA9PT0gdGhpcy5lbGVtZW50KTtcblxuICAgICAgICBpZiAoaW5kZXggPj0gMCkgV2lyaW5nTWFuYWdlci53aXJlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcih7IHgsIHkgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9ID0geyB4OiAwLCB5OiAwIH0pIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBodG1sYDxidXR0b24gY2xhc3M9XCJib2FyZC1vdXRwdXRcIj5PPC9idXR0b24+YDtcblxuICAgICAgICB0aGlzLm1vdmUoeCwgeSk7XG4gICAgfVxuXG4gICAgYXR0YWNoKCkge1xuICAgICAgICBzdXBlci5hdHRhY2goKTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHN1cGVyLmRldGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgdGhpcy4jY29udGV4dG1lbnUpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBmdW5jdGlvbiBodG1sKHRlbXBsYXRlOiBUZW1wbGF0ZVN0cmluZ3NBcnJheSwgLi4udmFsdWVzOiB1bmtub3duW10pOiBIVE1MRWxlbWVudDtcbmV4cG9ydCBmdW5jdGlvbiBodG1sKGh0bWw6IHN0cmluZyk6IEhUTUxFbGVtZW50O1xuZXhwb3J0IGZ1bmN0aW9uIGh0bWwoLi4uYXJnczogW3N0cmluZ10gfCBbVGVtcGxhdGVTdHJpbmdzQXJyYXksIC4uLnVua25vd25bXV0pIHtcbiAgICBjb25zdCBbdGVtcGxhdGUsIC4uLnZhbHVlc10gPSBhcmdzO1xuXG4gICAgY29uc3QgaHRtbCA9XG4gICAgICAgIHR5cGVvZiB0ZW1wbGF0ZSA9PT0gXCJzdHJpbmdcIiA/IHRlbXBsYXRlIDogdGVtcGxhdGUucmVkdWNlKChodG1sLCB0ZXh0LCBpKSA9PiBodG1sICsgdGV4dCArIHZhbHVlc1tpXSA/PyBcIlwiLCBcIlwiKTtcblxuICAgIHJldHVybiBuZXcgRE9NUGFyc2VyKCkucGFyc2VGcm9tU3RyaW5nKGh0bWwsIFwidGV4dC9odG1sXCIpLmJvZHkuY2hpbGROb2Rlc1swXTtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFJlaWZpZWQge1xuICAgIHN0YXRpYyByZWFkb25seSByb290ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5yZWlmaWVkLXJvb3RcIikgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICBhYnN0cmFjdCByZWFkb25seSBlbGVtZW50OiBIVE1MRWxlbWVudDtcblxuICAgIG1vdmUoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSB4ICsgXCJweFwiO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0geSArIFwicHhcIjtcbiAgICB9XG5cbiAgICBhdHRhY2goKSB7XG4gICAgICAgIFJlaWZpZWQucm9vdC5hcHBlbmQodGhpcy5lbGVtZW50KTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmUoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyB1c2VDYW52YXMgfSBmcm9tIFwiLi9jYW52YXNcIjtcblxuZXhwb3J0IGNsYXNzIFdpcmluZyB7XG4gICAgY29uc3RydWN0b3IocmVhZG9ubHkgZnJvbTogSFRNTEVsZW1lbnQsIHJlYWRvbmx5IHRvOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICAgICAgICB0by5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZhdGVkXCIsIGZyb20uY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZhdGVkXCIpKTtcbiAgICAgICAgfSkub2JzZXJ2ZShmcm9tLCB7IGF0dHJpYnV0ZUZpbHRlcjogW1wiY2xhc3NcIl0sIGF0dHJpYnV0ZXM6IHRydWUgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgV2lyaW5nTWFuYWdlciB7XG4gICAgc3RhdGljIHdpcmVzID0gW10gYXMgV2lyaW5nW107XG5cbiAgICBzdGF0aWMgcmVuZGVyKCkge1xuICAgICAgICBjb25zdCBjdHggPSB1c2VDYW52YXMoKTtcblxuICAgICAgICB0aGlzLndpcmVzLmZvckVhY2goKHdpcmUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGZyb20gPSB3aXJlLmZyb20uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgICAgICBjb25zdCB0byA9IHdpcmUudG8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHdpcmUuZnJvbS5jbGFzc0xpc3QuY29udGFpbnMoXCJhY3RpdmF0ZWRcIikgPyBcIiNmZjI2MjZcIiA6IFwiI2RlZGVkZVwiO1xuXG4gICAgICAgICAgICBjdHgubGluZVdpZHRoID0gNTtcblxuICAgICAgICAgICAgY3R4LmxpbmVKb2luID0gXCJyb3VuZFwiO1xuXG4gICAgICAgICAgICBjdHguYmVnaW5QYXRoKCk7XG4gICAgICAgICAgICBjdHgubW92ZVRvKGZyb20ueCArIGZyb20ud2lkdGggLyAyLCBmcm9tLnkgKyBmcm9tLmhlaWdodCAvIDIpO1xuICAgICAgICAgICAgY3R4LmxpbmVUbyh0by54ICsgdG8ud2lkdGggLyAyLCB0by55ICsgdG8uaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG4gICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cbn1cbiIsImNvbnN0IGN0eCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJjYW52YXNcIikhLmdldENvbnRleHQoXCIyZFwiKSE7XG5cbmV4cG9ydCBmdW5jdGlvbiB1c2VDYW52YXMoKSB7XG4gICAgY3R4LmNhbnZhcy53aWR0aCA9IHdpbmRvdy5pbm5lcldpZHRoO1xuICAgIGN0eC5jYW52YXMuaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuXG4gICAgcmV0dXJuIGN0eDtcbn1cbiIsImltcG9ydCB7IEJvb2xlYW5UdXBsZSB9IGZyb20gXCIuL3R5cGVzXCI7XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDaGlwPEkgZXh0ZW5kcyBudW1iZXIsIE8gZXh0ZW5kcyBudW1iZXI+IHtcbiAgICByZWFkb25seSBuYW1lO1xuXG4gICAgcmVhZG9ubHkgaW5wdXRzO1xuICAgIHJlYWRvbmx5IG91dHB1dHM7XG5cbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcsIGlucHV0czogSSwgb3V0cHV0czogTykge1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmlucHV0cyA9IGlucHV0cztcbiAgICAgICAgdGhpcy5vdXRwdXRzID0gb3V0cHV0cztcbiAgICB9XG5cbiAgICBhYnN0cmFjdCBvdXRwdXQoaW5wdXRzOiBCb29sZWFuVHVwbGU8ST4pOiBCb29sZWFuVHVwbGU8Tz47XG5cbiAgICBldmFsdWF0ZShpbnB1dHM6IGJvb2xlYW5bXSkge1xuICAgICAgICByZXR1cm4gdGhpcy5vdXRwdXQoaW5wdXRzIGFzIEJvb2xlYW5UdXBsZTxJLCBbXT4pIGFzIGJvb2xlYW5bXTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBBbmRHYXRlIGV4dGVuZHMgQ2hpcDwyLCAxPiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiQU5EXCIsIDIsIDEpO1xuICAgIH1cblxuICAgIG91dHB1dChbYSwgYl06IFtib29sZWFuLCBib29sZWFuXSk6IFtib29sZWFuXSB7XG4gICAgICAgIHJldHVybiBbYSAmJiBiXTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBPckdhdGUgZXh0ZW5kcyBDaGlwPDIsIDE+IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXCJPUlwiLCAyLCAxKTtcbiAgICB9XG5cbiAgICBvdXRwdXQoW2EsIGJdOiBbYm9vbGVhbiwgYm9vbGVhbl0pOiBbYm9vbGVhbl0ge1xuICAgICAgICByZXR1cm4gW2EgfHwgYl07XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgTm90R2F0ZSBleHRlbmRzIENoaXA8MSwgMT4ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcIk5PVFwiLCAxLCAxKTtcbiAgICB9XG5cbiAgICBvdXRwdXQoW25dOiBbYm9vbGVhbl0pOiBbYm9vbGVhbl0ge1xuICAgICAgICByZXR1cm4gWyFuXTtcbiAgICB9XG59XG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsImltcG9ydCB7IEFuZEdhdGUgfSBmcm9tIFwiLi9jaGlwc1wiO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSBcIi4vQ29tcG9uZW50XCI7XG5pbXBvcnQgeyBEcmFnZ2luZ01hbmFnZXIgfSBmcm9tIFwiLi9EcmFnZ2luZ01hbmFnZXJcIjtcbmltcG9ydCB7IElucHV0IH0gZnJvbSBcIi4vSW5wdXRcIjtcbmltcG9ydCB7IE1lbnVNYW5hZ2VyIH0gZnJvbSBcIi4vTWVudU1hbmFnZXJcIjtcbmltcG9ydCB7IE91dHB1dCB9IGZyb20gXCIuL091dHB1dFwiO1xuaW1wb3J0IHsgUmVpZmllZCB9IGZyb20gXCIuL1JlaWZpZWRcIjtcbmltcG9ydCB7IFdpcmluZywgV2lyaW5nTWFuYWdlciB9IGZyb20gXCIuL1dpcmluZ01hbmFnZXJcIjtcblxuY29uc3QgYSA9IG5ldyBJbnB1dCh7IHg6IDEwMCwgeTogMTAwIH0pO1xuY29uc3QgYiA9IG5ldyBJbnB1dCh7IHg6IDEwMCwgeTogMjAwIH0pO1xuY29uc3QgYyA9IG5ldyBDb21wb25lbnQobmV3IEFuZEdhdGUoKSwgeyB4OiAzMDAsIHk6IDE1MCB9KTtcbmNvbnN0IGQgPSBuZXcgT3V0cHV0KHsgeDogNTAwLCB5OiAxNTAgfSk7XG5cbmNvbnN0IGFjdGl2ZSA9IG5ldyBTZXQoW2EsIGIsIGMsIGRdKTtcblxuRHJhZ2dpbmdNYW5hZ2VyLmxpc3RlbigpO1xuXG5hY3RpdmUuZm9yRWFjaCgoYykgPT4ge1xuICAgIGMuYXR0YWNoKCk7XG5cbiAgICBpZiAoYyBpbnN0YW5jZW9mIENvbXBvbmVudCkge1xuICAgICAgICBEcmFnZ2luZ01hbmFnZXIud2F0Y2goYy5lbGVtZW50LCBjLmVsZW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MRWxlbWVudD4oXCIuY29tcG9uZW50LW5hbWVcIikhKTtcbiAgICB9XG59KTtcblxuV2lyaW5nTWFuYWdlci53aXJlcy5wdXNoKG5ldyBXaXJpbmcoYS5lbGVtZW50LCBjLmlucHV0c1swXSkpO1xuV2lyaW5nTWFuYWdlci53aXJlcy5wdXNoKG5ldyBXaXJpbmcoYi5lbGVtZW50LCBjLmlucHV0c1sxXSkpO1xuV2lyaW5nTWFuYWdlci53aXJlcy5wdXNoKG5ldyBXaXJpbmcoYy5vdXRwdXRzWzBdLCBkLmVsZW1lbnQpKTtcblxuTWVudU1hbmFnZXIudXNlKFJlaWZpZWQucm9vdCwgW1xuICAgIHtcbiAgICAgICAgXCJpbnNlcnQtY2hpcFwiOiB7XG4gICAgICAgICAgICBsYWJlbDogXCJJbnNlcnQgY2hpcFwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHt9LFxuICAgICAgICB9LFxuICAgIH0sXG4gICAge1xuICAgICAgICBcIm5ldy1pbnB1dFwiOiB7XG4gICAgICAgICAgICBsYWJlbDogXCJOZXcgaW5wdXRcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7fSxcbiAgICAgICAgfSxcbiAgICAgICAgXCJuZXctb3V0cHV0XCI6IHtcbiAgICAgICAgICAgIGxhYmVsOiBcIk5ldyBvdXRwdXRcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7fSxcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgXCJuZXctY2hpcFwiOiB7XG4gICAgICAgICAgICBsYWJlbDogXCJOZXcgY2hpcCBmcm9tIGRpYWdyYW1cIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7fSxcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgXCJzYXZlLWFzXCI6IHtcbiAgICAgICAgICAgIGxhYmVsOiBcIlNhdmUgYXMgZmlsZVwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHt9LFxuICAgICAgICB9LFxuICAgIH0sXG5dKTtcblxuKGZ1bmN0aW9uIGxvb3AoKSB7XG4gICAgV2lyaW5nTWFuYWdlci5yZW5kZXIoKTtcblxuICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShsb29wKTtcbn0pKCk7XG4iXSwibmFtZXMiOlsiQ29tcG9uZW50IiwiUmVpZmllZCIsImVsZW1lbnQiLCJpbnB1dHMiLCJvdXRwdXRzIiwiTWFwIiwiY2hpcCIsImNvbnN0cnVjdG9yIiwieCIsInkiLCJzdXBlciIsInRoaXMiLCJodG1sIiwiQXJyYXkiLCJmaWxsIiwiam9pbiIsIm5hbWUiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJpbnB1dCIsInNldCIsIk11dGF0aW9uT2JzZXJ2ZXIiLCJvdXQiLCJldmFsdWF0ZSIsIm1hcCIsImkiLCJjbGFzc0xpc3QiLCJjb250YWlucyIsIm91dHB1dCIsInRvZ2dsZSIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbiIsImluZGV4IiwiV2lyaW5nTWFuYWdlciIsInciLCJ0byIsIm1vdmUiLCJhdHRhY2giLCJnZXQiLCJvYnNlcnZlIiwiYXR0cmlidXRlRmlsdGVyIiwiYXR0cmlidXRlcyIsImFkZEV2ZW50TGlzdGVuZXIiLCJkZXRhY2giLCJvIiwiZGlzY29ubmVjdCIsImwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiRHJhZ2dpbmdNYW5hZ2VyIiwic3RhdGljIiwidW5kZWZpbmVkIiwib3giLCJveSIsImRvd24iLCJ0YXJnZXQiLCJkYXRhc2V0Iiwid2F0Y2hlZCIsIm1vdXNlZG93biIsImRyYWdnZWQiLCJzdHlsZSIsImN1cnNvciIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJib2R5IiwicGFyZW50RWxlbWVudCIsIkRPTVJlY3QiLCJjbGllbnRYIiwibGVmdCIsImNsaWVudFkiLCJ0b3AiLCJjYXB0dXJlIiwibGlzdGVuZXIiLCJFcnJvciIsImRlbGV0ZSIsImRvY3VtZW50Iiwid2luZG93IiwiSW5wdXQiLCJNZW51TWFuYWdlciIsImFjdGlvbnMiLCJtZW51IiwicmVjb3JkIiwiT2JqZWN0IiwiZW50cmllcyIsImxhYmVsIiwiY2xpY2tzIiwia2V5cyIsImtleSIsInF1ZXJ5U2VsZWN0b3IiLCJjYWxsYmFjayIsImNhbGwiLCJkaXNwbGF5IiwiYXBwZW5kQ2hpbGQiLCJjb250ZXh0bWVudSIsImNsaWNrIiwibGlzdGVuZXJzIiwicmVtb3ZlIiwiT3V0cHV0IiwiYXJncyIsInRlbXBsYXRlIiwidmFsdWVzIiwicmVkdWNlIiwidGV4dCIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsImNoaWxkTm9kZXMiLCJyb290IiwiYXBwZW5kIiwiV2lyaW5nIiwiY3R4IiwidXNlQ2FudmFzIiwid2lyZXMiLCJ3aXJlIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJsaW5lSm9pbiIsImJlZ2luUGF0aCIsIm1vdmVUbyIsIndpZHRoIiwiaGVpZ2h0IiwibGluZVRvIiwiY2xvc2VQYXRoIiwic3Ryb2tlIiwiZ2V0Q29udGV4dCIsImNhbnZhcyIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsIkNoaXAiLCJBbmRHYXRlIiwiYSIsImIiLCJPckdhdGUiLCJOb3RHYXRlIiwibiIsIl9fd2VicGFja19tb2R1bGVfY2FjaGVfXyIsIl9fd2VicGFja19yZXF1aXJlX18iLCJtb2R1bGVJZCIsImNhY2hlZE1vZHVsZSIsImV4cG9ydHMiLCJtb2R1bGUiLCJfX3dlYnBhY2tfbW9kdWxlc19fIiwiZCIsImRlZmluaXRpb24iLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsImMiLCJhY3RpdmUiLCJTZXQiLCJsb29wIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==