/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/Component.ts":(e,t,n)=>{n.r(t),n.d(t,{Component:()=>o});var s=n("./src/contextmenu.ts"),i=n("./src/Reified.ts"),r=n("./src/WiringManager.ts");class o extends i.Reified{element;inputs;outputs;name;#e=new Map;#t=new Map;chip;constructor(e,{x:t,y:n}={x:0,y:0}){super(),this.chip=e,this.element=i.html`
            <div class="component">
                <div class="component-inputs">
                    ${Array(this.chip.inputs).fill('<button class="component-input-button">I</button>').join("")}
                </div>
                <p class="component-name">${this.chip.name}</p>
                <div class="component-outputs">
                    ${Array(this.chip.outputs).fill('<button class="component-output-button">O</button>').join("")}
                </div>
            </div>
        `,this.inputs=Array.from(this.element.querySelectorAll(".component-input-button")),this.outputs=Array.from(this.element.querySelectorAll(".component-output-button")),this.name=this.element.querySelector(".component-name"),this.inputs.forEach((e=>{this.#e.set(e,new MutationObserver((()=>{const e=this.chip.evaluate(this.inputs.map((e=>e.classList.contains("activated"))));this.outputs.forEach(((t,n)=>{t.classList.toggle("activated",e[n])}))}))),this.#t.set(e,(()=>{(0,s.queueNewContext)((t=>[{"delete-connection":{label:"Delete connection",callback:()=>{r.WiringManager.wires=r.WiringManager.wires.filter((t=>t.to!==e))}}},...t]))}))})),this.outputs.forEach((e=>{this.#t.set(e,(()=>{(0,s.queueNewContext)((t=>[{"delete-connections":{label:"Delete connections",callback:()=>{r.WiringManager.wires=r.WiringManager.wires.filter((t=>t.from!==e))}}},...t]))}))})),this.#t.set(this.name,(()=>{(0,s.queueNewContext)((e=>[{"delete-component":{label:"Delete component",callback:()=>{this.detach(),r.WiringManager.wires=r.WiringManager.wires.filter((e=>this.inputs.every((t=>e.to!==t))&&this.outputs.every((t=>e.from!==t))))}},"delete-connections":{label:"Delete connections",callback:()=>{r.WiringManager.wires=r.WiringManager.wires.filter((e=>this.inputs.every((t=>e.to!==t))&&this.outputs.every((t=>e.from!==t))))}}},...e]))})),this.move(t,n)}attach(){super.attach(),this.inputs.forEach((e=>{this.#e.get(e).observe(e,{attributeFilter:["class"],attributes:!0}),e.addEventListener("contextmenu",this.#t.get(e))})),this.outputs.forEach((e=>{e.addEventListener("contextmenu",this.#t.get(e))})),this.name.addEventListener("contextmenu",this.#t.get(this.name))}detach(){super.detach(),this.#e.forEach((e=>e.disconnect())),this.#t.forEach(((e,t)=>t.removeEventListener("contextmenu",e)))}}},"./src/DraggingManager.ts":(e,t,n)=>{n.r(t),n.d(t,{DraggingManager:()=>s});class s{static#n;static#s={x:-1,y:-1,ox:-1,oy:-1,down:!1};static#i=new Map;static watch(e,t=e){e.dataset.watched="true";const n=t=>{this.#n=e,this.#n.dataset.dragged="true",this.#n.style.cursor="grabbing";const n=this.#n.getBoundingClientRect(),s=this.#n.parentElement?.getBoundingClientRect()??new DOMRect;this.#s.ox=t.clientX-n.left+s.left,this.#s.oy=t.clientY-n.top+s.top};t.addEventListener("mousedown",n,{capture:!0}),this.#i.set(t,n)}static forget(e){const t=this.#i.get(e);if(!t)throw new Error("Element is not currently being watched.");delete e.dataset.watched,e.removeEventListener("mousedown",t,{capture:!0}),this.#i.delete(e)}static listen(){document.body.addEventListener("mousemove",this.#r),window.addEventListener("mousedown",this.#o),window.addEventListener("mouseup",this.#a)}static deafen(){document.body.removeEventListener("mousemove",this.#r),window.removeEventListener("mousedown",this.#o),window.removeEventListener("mouseup",this.#a)}static#r=e=>{this.#s.x=e.clientX,this.#s.y=e.clientY,this.#n&&(this.#n.style.left=this.#s.x-this.#s.ox+"px",this.#n.style.top=this.#s.y-this.#s.oy+"px")};static#o=e=>{this.#s.down=!0};static#a=()=>{this.#n&&document.querySelectorAll('[data-dragged="true"]').forEach((e=>{delete e.dataset.dragged,e.style.cursor=""})),this.#s.down=!1,this.#s.x=-1,this.#s.y=-1,this.#s.ox=-1,this.#s.oy=-1,this.#n=void 0}}},"./src/Input.ts":(e,t,n)=>{n.r(t),n.d(t,{Input:()=>o});var s=n("./src/contextmenu.ts"),i=n("./src/Reified.ts"),r=n("./src/WiringManager.ts");class o extends i.Reified{element;constructor({x:e,y:t}={x:0,y:0}){super(),this.element=i.html`<button class="board-input">I</button>`,this.move(e,t)}#c=()=>{this.element.classList.toggle("activated")};#u=()=>{(0,s.queueNewContext)((e=>[{"delete-input":{label:"Delete input",callback:()=>{this.detach()}},"delete-connections":{label:"Delete connections",callback:()=>{r.WiringManager.wires=r.WiringManager.wires.filter((e=>e.from!==this.element))}}},...e]))};attach(){super.attach(),this.element.addEventListener("click",this.#c),this.element.addEventListener("contextmenu",this.#u)}detach(){super.detach(),this.element.removeEventListener("click",this.#c),this.element.removeEventListener("contextmenu",this.#u),r.WiringManager.wires=r.WiringManager.wires.filter((e=>e.from!==this.element))}}},"./src/MenuManager.ts":(e,t,n)=>{n.r(t),n.d(t,{MenuManager:()=>i});var s=n("./src/Reified.ts");class i{static#l=new Map;static use(e,t){const n=s.html`
            <div class="contextmenu">
                ${t.map((e=>Object.entries(e).map((([e,{label:t}])=>`<button class="${e}">${t}</button>`)).join(""))).join('<div class="br"></div>')}
            </div>
        `,i=new Map,r=e=>{i.clear(),n.innerHTML=e.map((e=>Object.entries(e).map((([e,{label:t}])=>`<button class="${e}">${t}</button>`)).join(""))).join('<div class="br"></div>'),e.forEach((e=>{Object.keys(e).forEach((t=>{const s=e[t].callback.bind(void 0);n.querySelector("."+t).addEventListener("click",s),n.querySelector("."+t).addEventListener("contextmenu",s),i.set(t,i)}))}))};let o;const a=()=>{if(o){const e=o;return o=void 0,e}return t};r(a()),n.style.left="0px",n.style.top="0px",n.style.display="none",document.body.appendChild(n);const c=()=>{r(a()),n.style.left="0px",n.style.top="0px",n.style.display="none"},u=e=>{e.preventDefault(),r(a()),n.style.display="",n.style.left=e.clientX+"px",n.style.top=e.clientY+"px"},l=e=>{e.preventDefault(),r(a()),n.style.left="0px",n.style.top="0px",n.style.display="none"};return e.addEventListener("mousedown",c),e.addEventListener("contextmenu",u),n.addEventListener("click",l),n.addEventListener("contextmenu",l),this.#l.set(e,{menu:n,clicks:i,listeners:{mousedown:c,contextmenu:u,click:l}}),[e=>{o=e.call(void 0,[...t])}]}static remove(e){const{menu:t,clicks:n,listeners:s}=this.#l.get(e)??{};if(!t||!n||!s)throw new Error("Elements are not being affected.");e.removeEventListener("mousedown",s.mousedown),e.removeEventListener("contextmenu",s.contextmenu),t.removeEventListener("click",s.click),t.removeEventListener("contextmenu",s.click),Array.from(n).forEach((([e,n])=>{t.querySelector("."+e).removeEventListener("click",n),t.querySelector("."+e).removeEventListener("contextmenu",n)})),t.remove()}}},"./src/Output.ts":(e,t,n)=>{n.r(t),n.d(t,{Output:()=>o});var s=n("./src/contextmenu.ts"),i=n("./src/Reified.ts"),r=n("./src/WiringManager.ts");class o extends i.Reified{element;#u=()=>{(0,s.queueNewContext)((e=>[{"delete-output":{label:"Delete output",callback:()=>{this.detach()}},"delete-connection":{label:"Delete connection",callback:()=>{r.WiringManager.wires=r.WiringManager.wires.filter((e=>e.to!==this.element))}}},...e]))};constructor({x:e,y:t}={x:0,y:0}){super(),this.element=i.html`<button class="board-output">O</button>`,this.move(e,t)}attach(){super.attach(),this.element.addEventListener("contextmenu",this.#u)}detach(){super.detach(),this.element.removeEventListener("contextmenu",this.#u),r.WiringManager.wires=r.WiringManager.wires.filter((e=>e.to!==this.element))}}},"./src/Reified.ts":(e,t,n)=>{function s(...e){const[t,...n]=e,s="string"==typeof t?t:t.reduce(((e,t,s)=>e+t+n[s]??""),"");return(new DOMParser).parseFromString(s,"text/html").body.childNodes[0]}function i(e){e.preventDefault()}n.r(t),n.d(t,{Reified:()=>r,html:()=>s,preventDefault:()=>i});class r{static active=new Set;static root=document.querySelector(".reified-root");move(e,t){this.element.style.left=e+"px",this.element.style.top=t+"px"}attach(){r.active.add(this),r.root.append(this.element)}detach(){r.active.delete(this),this.element.remove()}}},"./src/WiringManager.ts":(e,t,n)=>{n.r(t),n.d(t,{Wiring:()=>i,WiringManager:()=>r});var s=n("./src/canvas.ts");class i{from;to;constructor(e,t){this.from=e,this.to=t,new MutationObserver((()=>{t.classList.toggle("activated",e.classList.contains("activated"))})).observe(e,{attributeFilter:["class"],attributes:!0})}}class r{static wires=new Array;static render(){const e=(0,s.useCanvas)();this.wires.forEach((t=>{const n=t.from.getBoundingClientRect(),s=t.to.getBoundingClientRect();e.strokeStyle=t.from.classList.contains("activated")?"#ff2626":"#dedede",e.lineWidth=5,e.lineJoin="round",e.beginPath(),e.moveTo(n.x+n.width/2,n.y+n.height/2),e.lineTo(s.x+s.width/2,s.y+s.height/2),e.closePath(),e.stroke()}))}}},"./src/canvas.ts":(e,t,n)=>{n.r(t),n.d(t,{useCanvas:()=>i});const s=document.querySelector("canvas").getContext("2d");function i(){return s.canvas.width=window.innerWidth,s.canvas.height=window.innerHeight,s}},"./src/chips.ts":(e,t,n)=>{n.r(t),n.d(t,{AndGate:()=>i,Chip:()=>s,NotGate:()=>o,OrGate:()=>r});class s{name;inputs;outputs;constructor(e,t,n){this.name=e,this.inputs=t,this.outputs=n}evaluate(e){return this.output(e)}}class i extends s{constructor(){super("AND",2,1)}output([e,t]){return[e&&t]}}class r extends s{constructor(){super("OR",2,1)}output([e,t]){return[e||t]}}class o extends s{constructor(){super("NOT",1,1)}output([e]){return[!e]}}},"./src/contextmenu.ts":(e,t,n)=>{n.r(t),n.d(t,{queueNewContext:()=>r});var s=n("./src/MenuManager.ts"),i=n("./src/Reified.ts");const[r]=s.MenuManager.use(i.Reified.root,[{"insert-chip":{label:"Insert chip",callback:()=>{}}},{"new-input":{label:"New input",callback:()=>{}},"new-output":{label:"New output",callback:()=>{}}},{"new-chip":{label:"New chip from diagram",callback:()=>{}}},{"save-as":{label:"Save as file",callback:()=>{}},"import-from":{label:"Import from file",callback:()=>{}}}])}},t={};function n(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};(()=>{n.r(s);var e=n("./src/chips.ts"),t=n("./src/Component.ts"),i=(n("./src/contextmenu.ts"),n("./src/DraggingManager.ts")),r=n("./src/Input.ts"),o=n("./src/Output.ts"),a=n("./src/WiringManager.ts");const c=new r.Input({x:100,y:100}),u=new r.Input({x:100,y:200}),l=new t.Component(new e.AndGate,{x:300,y:150}),d=new o.Output({x:500,y:150});[c,u,l,d].forEach((e=>{e.attach(),e instanceof t.Component&&i.DraggingManager.watch(e.element,e.element.querySelector(".component-name"))})),i.DraggingManager.listen(),a.WiringManager.wires.push(new a.Wiring(c.element,l.inputs[0])),a.WiringManager.wires.push(new a.Wiring(u.element,l.inputs[1])),a.WiringManager.wires.push(new a.Wiring(l.outputs[0],d.element)),function e(){a.WiringManager.render(),requestAnimationFrame(e)}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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S0FDeEQsRUFBQWlDLGNBQUEsV0FBeUIsSUFBSSxFQUFBbUYsT0FBTzRDLEVBQUUvSixRQUFRLEdBQUltSixFQUFFckosVUFFcEQsU0FBVWtLLElBQ04sRUFBQWhJLGNBQUEsU0FFQWlJLHNCQUFzQkQsRUFDekIsQ0FKRCIsInNvdXJjZXMiOlsid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9Db21wb25lbnQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL0RyYWdnaW5nTWFuYWdlci50cyIsIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vLi9zcmMvSW5wdXQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL01lbnVNYW5hZ2VyLnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9PdXRwdXQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL1JlaWZpZWQudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL1dpcmluZ01hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL2NhbnZhcy50cyIsIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vLi9zcmMvY2hpcHMudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL2NvbnRleHRtZW51LnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDaGlwIH0gZnJvbSBcIi4vY2hpcHNcIjtcbmltcG9ydCB7IHF1ZXVlTmV3Q29udGV4dCB9IGZyb20gXCIuL2NvbnRleHRtZW51XCI7XG5pbXBvcnQgeyBodG1sLCBSZWlmaWVkIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuaW1wb3J0IHsgV2lyaW5nTWFuYWdlciB9IGZyb20gXCIuL1dpcmluZ01hbmFnZXJcIjtcblxuZXhwb3J0IGNsYXNzIENvbXBvbmVudDxJIGV4dGVuZHMgbnVtYmVyLCBPIGV4dGVuZHMgbnVtYmVyPiBleHRlbmRzIFJlaWZpZWQge1xuICAgIHJlYWRvbmx5IGVsZW1lbnQ7XG5cbiAgICByZWFkb25seSBpbnB1dHM7XG4gICAgcmVhZG9ubHkgb3V0cHV0cztcbiAgICByZWFkb25seSBuYW1lO1xuXG4gICAgcmVhZG9ubHkgI29ic2VydmVycyA9IG5ldyBNYXA8RWxlbWVudCwgTXV0YXRpb25PYnNlcnZlcj4oKTtcbiAgICByZWFkb25seSAjY29udGV4dG1lbnVzID0gbmV3IE1hcDxFbGVtZW50LCAoKSA9PiB2b2lkPigpO1xuXG4gICAgcmVhZG9ubHkgY2hpcDogQ2hpcDxJLCBPPjtcblxuICAgIGNvbnN0cnVjdG9yKGNoaXA6IENoaXA8SSwgTz4sIHsgeCwgeSB9OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0gPSB7IHg6IDAsIHk6IDAgfSkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuY2hpcCA9IGNoaXA7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaHRtbGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21wb25lbnRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tcG9uZW50LWlucHV0c1wiPlxuICAgICAgICAgICAgICAgICAgICAke0FycmF5KHRoaXMuY2hpcC5pbnB1dHMpLmZpbGwoJzxidXR0b24gY2xhc3M9XCJjb21wb25lbnQtaW5wdXQtYnV0dG9uXCI+STwvYnV0dG9uPicpLmpvaW4oXCJcIil9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJjb21wb25lbnQtbmFtZVwiPiR7dGhpcy5jaGlwLm5hbWV9PC9wPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21wb25lbnQtb3V0cHV0c1wiPlxuICAgICAgICAgICAgICAgICAgICAke0FycmF5KHRoaXMuY2hpcC5vdXRwdXRzKS5maWxsKCc8YnV0dG9uIGNsYXNzPVwiY29tcG9uZW50LW91dHB1dC1idXR0b25cIj5PPC9idXR0b24+Jykuam9pbihcIlwiKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuXG4gICAgICAgIHRoaXMuaW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jb21wb25lbnQtaW5wdXQtYnV0dG9uXCIpKTtcbiAgICAgICAgdGhpcy5vdXRwdXRzID0gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jb21wb25lbnQtb3V0cHV0LWJ1dHRvblwiKSk7XG4gICAgICAgIHRoaXMubmFtZSA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXBvbmVudC1uYW1lXCIpITtcblxuICAgICAgICB0aGlzLmlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgICAgICAgdGhpcy4jb2JzZXJ2ZXJzLnNldChcbiAgICAgICAgICAgICAgICBpbnB1dCxcbiAgICAgICAgICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG91dCA9IHRoaXMuY2hpcC5ldmFsdWF0ZSh0aGlzLmlucHV0cy5tYXAoKGkpID0+IGkuY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZhdGVkXCIpKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRzLmZvckVhY2goKG91dHB1dCwgaSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LmNsYXNzTGlzdC50b2dnbGUoXCJhY3RpdmF0ZWRcIiwgb3V0W2ldKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgIHRoaXMuI2NvbnRleHRtZW51cy5zZXQoaW5wdXQsICgpID0+IHtcbiAgICAgICAgICAgICAgICBxdWV1ZU5ld0NvbnRleHQoKHByZXYpID0+IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJkZWxldGUtY29ubmVjdGlvblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiRGVsZXRlIGNvbm5lY3Rpb25cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBXaXJpbmdNYW5hZ2VyLndpcmVzID0gV2lyaW5nTWFuYWdlci53aXJlcy5maWx0ZXIoKHdpcmUpID0+IHdpcmUudG8gIT09IGlucHV0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgLi4ucHJldixcbiAgICAgICAgICAgICAgICBdKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLm91dHB1dHMuZm9yRWFjaCgob3V0cHV0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLiNjb250ZXh0bWVudXMuc2V0KG91dHB1dCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHF1ZXVlTmV3Q29udGV4dCgocHJldikgPT4gW1xuICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICBcImRlbGV0ZS1jb25uZWN0aW9uc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiRGVsZXRlIGNvbm5lY3Rpb25zXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgV2lyaW5nTWFuYWdlci53aXJlcyA9IFdpcmluZ01hbmFnZXIud2lyZXMuZmlsdGVyKCh3aXJlKSA9PiB3aXJlLmZyb20gIT09IG91dHB1dCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgICAgICAgICAgXSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy4jY29udGV4dG1lbnVzLnNldCh0aGlzLm5hbWUsICgpID0+IHtcbiAgICAgICAgICAgIHF1ZXVlTmV3Q29udGV4dCgocHJldikgPT4gW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgXCJkZWxldGUtY29tcG9uZW50XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkRlbGV0ZSBjb21wb25lbnRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhY2goKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFdpcmluZ01hbmFnZXIud2lyZXMgPSBXaXJpbmdNYW5hZ2VyLndpcmVzLmZpbHRlcihcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHdpcmUpID0+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlucHV0cy5ldmVyeSgoaSkgPT4gd2lyZS50byAhPT0gaSkgJiZcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0cy5ldmVyeSgobykgPT4gd2lyZS5mcm9tICE9PSBvKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBcImRlbGV0ZS1jb25uZWN0aW9uc1wiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsYWJlbDogXCJEZWxldGUgY29ubmVjdGlvbnNcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgV2lyaW5nTWFuYWdlci53aXJlcyA9IFdpcmluZ01hbmFnZXIud2lyZXMuZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAod2lyZSkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaW5wdXRzLmV2ZXJ5KChpKSA9PiB3aXJlLnRvICE9PSBpKSAmJlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5vdXRwdXRzLmV2ZXJ5KChvKSA9PiB3aXJlLmZyb20gIT09IG8pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAuLi5wcmV2LFxuICAgICAgICAgICAgXSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubW92ZSh4LCB5KTtcbiAgICB9XG5cbiAgICBhdHRhY2goKSB7XG4gICAgICAgIHN1cGVyLmF0dGFjaCgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLiNvYnNlcnZlcnMuZ2V0KGlucHV0KSEub2JzZXJ2ZShpbnB1dCwge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUZpbHRlcjogW1wiY2xhc3NcIl0sXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSxcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgdGhpcy4jY29udGV4dG1lbnVzLmdldChpbnB1dCkhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5vdXRwdXRzLmZvckVhY2goKG91dHB1dCkgPT4ge1xuICAgICAgICAgICAgb3V0cHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCB0aGlzLiNjb250ZXh0bWVudXMuZ2V0KG91dHB1dCkhKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5uYW1lLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCB0aGlzLiNjb250ZXh0bWVudXMuZ2V0KHRoaXMubmFtZSkhKTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHN1cGVyLmRldGFjaCgpO1xuXG4gICAgICAgIHRoaXMuI29ic2VydmVycy5mb3JFYWNoKChvKSA9PiBvLmRpc2Nvbm5lY3QoKSk7XG5cbiAgICAgICAgdGhpcy4jY29udGV4dG1lbnVzLmZvckVhY2goKGxpc3RlbmVyLCBlbGVtZW50KSA9PiBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBsaXN0ZW5lcikpO1xuICAgIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBEcmFnZ2luZ01hbmFnZXIge1xuICAgIHN0YXRpYyAjZHJhZ2dlZDogSFRNTEVsZW1lbnQgfCB1bmRlZmluZWQ7XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgI21vdXNlID0ge1xuICAgICAgICB4OiAtMSxcbiAgICAgICAgeTogLTEsXG4gICAgICAgIG94OiAtMSxcbiAgICAgICAgb3k6IC0xLFxuICAgICAgICBkb3duOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgc3RhdGljIHJlYWRvbmx5ICN3YXRjaGVkID0gbmV3IE1hcCgpO1xuXG4gICAgc3RhdGljIHdhdGNoKGVsZW1lbnQ6IEhUTUxFbGVtZW50LCB0YXJnZXQgPSBlbGVtZW50KSB7XG4gICAgICAgIGVsZW1lbnQuZGF0YXNldC53YXRjaGVkID0gXCJ0cnVlXCI7XG5cbiAgICAgICAgY29uc3QgbW91c2Vkb3duID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuI2RyYWdnZWQgPSBlbGVtZW50O1xuXG4gICAgICAgICAgICB0aGlzLiNkcmFnZ2VkLmRhdGFzZXQuZHJhZ2dlZCA9IFwidHJ1ZVwiO1xuXG4gICAgICAgICAgICB0aGlzLiNkcmFnZ2VkLnN0eWxlLmN1cnNvciA9IFwiZ3JhYmJpbmdcIjtcblxuICAgICAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuI2RyYWdnZWQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB0aGlzLiNkcmFnZ2VkLnBhcmVudEVsZW1lbnQ/LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpID8/IG5ldyBET01SZWN0KCk7XG5cbiAgICAgICAgICAgIHRoaXMuI21vdXNlLm94ID0gZS5jbGllbnRYIC0gcmVjdC5sZWZ0ICsgYm9keS5sZWZ0O1xuICAgICAgICAgICAgdGhpcy4jbW91c2Uub3kgPSBlLmNsaWVudFkgLSByZWN0LnRvcCArIGJvZHkudG9wO1xuICAgICAgICB9O1xuXG4gICAgICAgIHRhcmdldC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vdXNlZG93biwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuXG4gICAgICAgIHRoaXMuI3dhdGNoZWQuc2V0KHRhcmdldCwgbW91c2Vkb3duKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZm9yZ2V0KGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IGxpc3RlbmVyID0gdGhpcy4jd2F0Y2hlZC5nZXQoZWxlbWVudCk7XG5cbiAgICAgICAgaWYgKCFsaXN0ZW5lcikgdGhyb3cgbmV3IEVycm9yKGBFbGVtZW50IGlzIG5vdCBjdXJyZW50bHkgYmVpbmcgd2F0Y2hlZC5gKTtcblxuICAgICAgICBkZWxldGUgZWxlbWVudC5kYXRhc2V0LndhdGNoZWQ7XG5cbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGxpc3RlbmVyLCB7IGNhcHR1cmU6IHRydWUgfSk7XG5cbiAgICAgICAgdGhpcy4jd2F0Y2hlZC5kZWxldGUoZWxlbWVudCk7XG4gICAgfVxuXG4gICAgc3RhdGljIGxpc3RlbigpIHtcbiAgICAgICAgZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIHRoaXMuI21vdXNlbW92ZSk7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuI21vdXNlZG93bik7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCB0aGlzLiNtb3VzZXVwKTtcbiAgICB9XG5cbiAgICBzdGF0aWMgZGVhZmVuKCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy4jbW91c2Vtb3ZlKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy4jbW91c2Vkb3duKTtcbiAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuI21vdXNldXApO1xuICAgIH1cblxuICAgIHN0YXRpYyByZWFkb25seSAjbW91c2Vtb3ZlID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgdGhpcy4jbW91c2UueCA9IGUuY2xpZW50WDtcbiAgICAgICAgdGhpcy4jbW91c2UueSA9IGUuY2xpZW50WTtcblxuICAgICAgICBpZiAodGhpcy4jZHJhZ2dlZCkge1xuICAgICAgICAgICAgdGhpcy4jZHJhZ2dlZC5zdHlsZS5sZWZ0ID0gdGhpcy4jbW91c2UueCAtIHRoaXMuI21vdXNlLm94ICsgXCJweFwiO1xuICAgICAgICAgICAgdGhpcy4jZHJhZ2dlZC5zdHlsZS50b3AgPSB0aGlzLiNtb3VzZS55IC0gdGhpcy4jbW91c2Uub3kgKyBcInB4XCI7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgc3RhdGljIHJlYWRvbmx5ICNtb3VzZWRvd24gPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICB0aGlzLiNtb3VzZS5kb3duID0gdHJ1ZTtcbiAgICB9O1xuXG4gICAgc3RhdGljIHJlYWRvbmx5ICNtb3VzZXVwID0gKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy4jZHJhZ2dlZCkge1xuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbDxIVE1MRWxlbWVudD4oJ1tkYXRhLWRyYWdnZWQ9XCJ0cnVlXCJdJykuZm9yRWFjaCgoZSkgPT4ge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSBlLmRhdGFzZXQuZHJhZ2dlZDtcblxuICAgICAgICAgICAgICAgIGUuc3R5bGUuY3Vyc29yID0gXCJcIjtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy4jbW91c2UuZG93biA9IGZhbHNlO1xuXG4gICAgICAgIHRoaXMuI21vdXNlLnggPSAtMTtcbiAgICAgICAgdGhpcy4jbW91c2UueSA9IC0xO1xuXG4gICAgICAgIHRoaXMuI21vdXNlLm94ID0gLTE7XG4gICAgICAgIHRoaXMuI21vdXNlLm95ID0gLTE7XG5cbiAgICAgICAgdGhpcy4jZHJhZ2dlZCA9IHVuZGVmaW5lZDtcbiAgICB9O1xufVxuIiwiaW1wb3J0IHsgcXVldWVOZXdDb250ZXh0IH0gZnJvbSBcIi4vY29udGV4dG1lbnVcIjtcbmltcG9ydCB7IGh0bWwsIFJlaWZpZWQgfSBmcm9tIFwiLi9SZWlmaWVkXCI7XG5pbXBvcnQgeyBXaXJpbmdNYW5hZ2VyIH0gZnJvbSBcIi4vV2lyaW5nTWFuYWdlclwiO1xuXG5leHBvcnQgY2xhc3MgSW5wdXQgZXh0ZW5kcyBSZWlmaWVkIHtcbiAgICByZWFkb25seSBlbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoeyB4LCB5IH06IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSA9IHsgeDogMCwgeTogMCB9KSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaHRtbGA8YnV0dG9uIGNsYXNzPVwiYm9hcmQtaW5wdXRcIj5JPC9idXR0b24+YDtcblxuICAgICAgICB0aGlzLm1vdmUoeCwgeSk7XG4gICAgfVxuXG4gICAgcmVhZG9ubHkgI2NsaWNrID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2YXRlZFwiKTtcbiAgICB9O1xuXG4gICAgcmVhZG9ubHkgI2NvbnRleHRtZW51ID0gKCkgPT4ge1xuICAgICAgICBxdWV1ZU5ld0NvbnRleHQoKHByZXYpID0+IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBcImRlbGV0ZS1pbnB1dFwiOiB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkRlbGV0ZSBpbnB1dFwiLFxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5kZXRhY2goKTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIFwiZGVsZXRlLWNvbm5lY3Rpb25zXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiRGVsZXRlIGNvbm5lY3Rpb25zXCIsXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBXaXJpbmdNYW5hZ2VyLndpcmVzID0gV2lyaW5nTWFuYWdlci53aXJlcy5maWx0ZXIoKHdpcmUpID0+IHdpcmUuZnJvbSAhPT0gdGhpcy5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgIF0pO1xuICAgIH07XG5cbiAgICBhdHRhY2goKSB7XG4gICAgICAgIHN1cGVyLmF0dGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy4jY2xpY2spO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHN1cGVyLmRldGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy4jY2xpY2spO1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcblxuICAgICAgICBXaXJpbmdNYW5hZ2VyLndpcmVzID0gV2lyaW5nTWFuYWdlci53aXJlcy5maWx0ZXIoKHdpcmUpID0+IHdpcmUuZnJvbSAhPT0gdGhpcy5lbGVtZW50KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBodG1sIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuXG5leHBvcnQgdHlwZSBNZW51TWFuYWdlckNvbnRleHQgPSB7XG4gICAgbWVudTogSFRNTEVsZW1lbnQ7XG4gICAgY2xpY2tzOiBNYXA8c3RyaW5nLCAoKSA9PiB2b2lkPjtcbiAgICBsaXN0ZW5lcnM6IHtcbiAgICAgICAgbW91c2Vkb3duOiAoZTogTW91c2VFdmVudCkgPT4gdm9pZDtcbiAgICAgICAgY29udGV4dG1lbnU6IChlOiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuICAgICAgICBjbGljazogKGU6IE1vdXNlRXZlbnQpID0+IHZvaWQ7XG4gICAgfTtcbn07XG5cbmV4cG9ydCB0eXBlIE1lbnVNYW5hZ2VyQWN0aW9ucyA9IEFycmF5PFJlY29yZDxzdHJpbmcsIHsgbGFiZWw6IHN0cmluZzsgY2FsbGJhY2s6IChlOiBNb3VzZUV2ZW50KSA9PiB2b2lkIH0+PjtcblxuZXhwb3J0IGNsYXNzIE1lbnVNYW5hZ2VyIHtcbiAgICBzdGF0aWMgcmVhZG9ubHkgI2VsZW1lbnRzID0gbmV3IE1hcDxIVE1MRWxlbWVudCwgTWVudU1hbmFnZXJDb250ZXh0PigpO1xuXG4gICAgc3RhdGljIHVzZShlbGVtZW50OiBIVE1MRWxlbWVudCwgYWN0aW9uczogTWVudU1hbmFnZXJBY3Rpb25zKSB7XG4gICAgICAgIGNvbnN0IG1lbnUgPSBodG1sYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRleHRtZW51XCI+XG4gICAgICAgICAgICAgICAgJHthY3Rpb25zXG4gICAgICAgICAgICAgICAgICAgIC5tYXAoKHJlY29yZCkgPT5cbiAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHJlY29yZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKChbbmFtZSwgeyBsYWJlbCB9XSkgPT4gYDxidXR0b24gY2xhc3M9XCIke25hbWV9XCI+JHtsYWJlbH08L2J1dHRvbj5gKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpXG4gICAgICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICAgICAgICAgLmpvaW4oJzxkaXYgY2xhc3M9XCJiclwiPjwvZGl2PicpfVxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIGA7XG5cbiAgICAgICAgY29uc3QgY2xpY2tzID0gbmV3IE1hcCgpO1xuXG4gICAgICAgIGNvbnN0IHNldHVwID0gKGFjdGlvbnM6IE1lbnVNYW5hZ2VyQWN0aW9ucykgPT4ge1xuICAgICAgICAgICAgY2xpY2tzLmNsZWFyKCk7XG5cbiAgICAgICAgICAgIG1lbnUuaW5uZXJIVE1MID0gYWN0aW9uc1xuICAgICAgICAgICAgICAgIC5tYXAoKHJlY29yZCkgPT5cbiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMocmVjb3JkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm1hcCgoW25hbWUsIHsgbGFiZWwgfV0pID0+IGA8YnV0dG9uIGNsYXNzPVwiJHtuYW1lfVwiPiR7bGFiZWx9PC9idXR0b24+YClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5qb2luKFwiXCIpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIC5qb2luKCc8ZGl2IGNsYXNzPVwiYnJcIj48L2Rpdj4nKTtcblxuICAgICAgICAgICAgYWN0aW9ucy5mb3JFYWNoKChyZWNvcmQpID0+IHtcbiAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhyZWNvcmQpLmZvckVhY2goKGtleSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGljayA9IHJlY29yZFtrZXldLmNhbGxiYWNrLmJpbmQodW5kZWZpbmVkKTtcblxuICAgICAgICAgICAgICAgICAgICBtZW51LnF1ZXJ5U2VsZWN0b3I8SFRNTEVsZW1lbnQ+KFwiLlwiICsga2V5KSEuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrKTtcbiAgICAgICAgICAgICAgICAgICAgbWVudS5xdWVyeVNlbGVjdG9yPEhUTUxFbGVtZW50PihcIi5cIiArIGtleSkhLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBjbGljayk7XG5cbiAgICAgICAgICAgICAgICAgICAgY2xpY2tzLnNldChrZXksIGNsaWNrcyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICBsZXQgY29udGV4dDogTWVudU1hbmFnZXJBY3Rpb25zIHwgdW5kZWZpbmVkO1xuXG4gICAgICAgIGNvbnN0IGdldEFjdGlvbnMgPSAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoY29udGV4dCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGFjdGlvbnMgPSBjb250ZXh0O1xuXG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgICAgIHJldHVybiBhY3Rpb25zO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gYWN0aW9ucztcbiAgICAgICAgfTtcblxuICAgICAgICBzZXR1cChnZXRBY3Rpb25zKCkpO1xuXG4gICAgICAgIG1lbnUuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgICAgIG1lbnUuc3R5bGUudG9wID0gXCIwcHhcIjtcbiAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtZW51KTtcblxuICAgICAgICBjb25zdCBtb3VzZWRvd24gPSAoKSA9PiB7XG4gICAgICAgICAgICBzZXR1cChnZXRBY3Rpb25zKCkpO1xuXG4gICAgICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY29udGV4dG1lbnUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBzZXR1cChnZXRBY3Rpb25zKCkpO1xuXG4gICAgICAgICAgICBtZW51LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5sZWZ0ID0gZS5jbGllbnRYICsgXCJweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBlLmNsaWVudFkgKyBcInB4XCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY2xpY2sgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBzZXR1cChnZXRBY3Rpb25zKCkpO1xuXG4gICAgICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vdXNlZG93bik7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGNvbnRleHRtZW51KTtcbiAgICAgICAgbWVudS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2spO1xuICAgICAgICBtZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBjbGljayk7XG5cbiAgICAgICAgdGhpcy4jZWxlbWVudHMuc2V0KGVsZW1lbnQsIHsgbWVudSwgY2xpY2tzLCBsaXN0ZW5lcnM6IHsgbW91c2Vkb3duLCBjb250ZXh0bWVudSwgY2xpY2sgfSB9KTtcblxuICAgICAgICByZXR1cm4gW1xuICAgICAgICAgICAgKG5ld0NvbnRleHQ6IChwcmV2OiBNZW51TWFuYWdlckFjdGlvbnMpID0+IE1lbnVNYW5hZ2VyQWN0aW9ucykgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnRleHQgPSBuZXdDb250ZXh0LmNhbGwodW5kZWZpbmVkLCBbLi4uYWN0aW9uc10pO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgXTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcmVtb3ZlKGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHsgbWVudSwgY2xpY2tzLCBsaXN0ZW5lcnMgfSA9IHRoaXMuI2VsZW1lbnRzLmdldChlbGVtZW50KSA/PyB7fTtcblxuICAgICAgICBpZiAoIW1lbnUgfHwgIWNsaWNrcyB8fCAhbGlzdGVuZXJzKSB0aHJvdyBuZXcgRXJyb3IoYEVsZW1lbnRzIGFyZSBub3QgYmVpbmcgYWZmZWN0ZWQuYCk7XG5cbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGxpc3RlbmVycy5tb3VzZWRvd24pO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBsaXN0ZW5lcnMuY29udGV4dG1lbnUpO1xuICAgICAgICBtZW51LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBsaXN0ZW5lcnMuY2xpY2spO1xuICAgICAgICBtZW51LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBsaXN0ZW5lcnMuY2xpY2spO1xuXG4gICAgICAgIEFycmF5LmZyb20oY2xpY2tzKS5mb3JFYWNoKChba2V5LCBsaXN0ZW5lcl0pID0+IHtcbiAgICAgICAgICAgIG1lbnUucXVlcnlTZWxlY3RvcihcIi5cIiArIGtleSkhLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBsaXN0ZW5lcik7XG4gICAgICAgICAgICBtZW51LnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyBrZXkpIS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgbGlzdGVuZXIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBtZW51LnJlbW92ZSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IHF1ZXVlTmV3Q29udGV4dCB9IGZyb20gXCIuL2NvbnRleHRtZW51XCI7XG5pbXBvcnQgeyBodG1sLCBSZWlmaWVkIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuaW1wb3J0IHsgV2lyaW5nTWFuYWdlciB9IGZyb20gXCIuL1dpcmluZ01hbmFnZXJcIjtcblxuZXhwb3J0IGNsYXNzIE91dHB1dCBleHRlbmRzIFJlaWZpZWQge1xuICAgIHJlYWRvbmx5IGVsZW1lbnQ7XG5cbiAgICByZWFkb25seSAjY29udGV4dG1lbnUgPSAoKSA9PiB7XG4gICAgICAgIHF1ZXVlTmV3Q29udGV4dCgocHJldikgPT4gW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIFwiZGVsZXRlLW91dHB1dFwiOiB7XG4gICAgICAgICAgICAgICAgICAgIGxhYmVsOiBcIkRlbGV0ZSBvdXRwdXRcIixcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZGV0YWNoKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBcImRlbGV0ZS1jb25uZWN0aW9uXCI6IHtcbiAgICAgICAgICAgICAgICAgICAgbGFiZWw6IFwiRGVsZXRlIGNvbm5lY3Rpb25cIixcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFdpcmluZ01hbmFnZXIud2lyZXMgPSBXaXJpbmdNYW5hZ2VyLndpcmVzLmZpbHRlcigod2lyZSkgPT4gd2lyZS50byAhPT0gdGhpcy5lbGVtZW50KTtcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIC4uLnByZXYsXG4gICAgICAgIF0pO1xuICAgIH07XG5cbiAgICBjb25zdHJ1Y3Rvcih7IHgsIHkgfTogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9ID0geyB4OiAwLCB5OiAwIH0pIHtcbiAgICAgICAgc3VwZXIoKTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQgPSBodG1sYDxidXR0b24gY2xhc3M9XCJib2FyZC1vdXRwdXRcIj5PPC9idXR0b24+YDtcblxuICAgICAgICB0aGlzLm1vdmUoeCwgeSk7XG4gICAgfVxuXG4gICAgYXR0YWNoKCkge1xuICAgICAgICBzdXBlci5hdHRhY2goKTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHN1cGVyLmRldGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgdGhpcy4jY29udGV4dG1lbnUpO1xuXG4gICAgICAgIFdpcmluZ01hbmFnZXIud2lyZXMgPSBXaXJpbmdNYW5hZ2VyLndpcmVzLmZpbHRlcigod2lyZSkgPT4gd2lyZS50byAhPT0gdGhpcy5lbGVtZW50KTtcbiAgICB9XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gaHRtbCh0ZW1wbGF0ZTogVGVtcGxhdGVTdHJpbmdzQXJyYXksIC4uLnZhbHVlczogdW5rbm93bltdKTogSFRNTEVsZW1lbnQ7XG5leHBvcnQgZnVuY3Rpb24gaHRtbChodG1sOiBzdHJpbmcpOiBIVE1MRWxlbWVudDtcbmV4cG9ydCBmdW5jdGlvbiBodG1sKC4uLmFyZ3M6IFtzdHJpbmddIHwgW1RlbXBsYXRlU3RyaW5nc0FycmF5LCAuLi51bmtub3duW11dKSB7XG4gICAgY29uc3QgW3RlbXBsYXRlLCAuLi52YWx1ZXNdID0gYXJncztcblxuICAgIGNvbnN0IGh0bWwgPVxuICAgICAgICB0eXBlb2YgdGVtcGxhdGUgPT09IFwic3RyaW5nXCIgPyB0ZW1wbGF0ZSA6IHRlbXBsYXRlLnJlZHVjZSgoaHRtbCwgdGV4dCwgaSkgPT4gaHRtbCArIHRleHQgKyB2YWx1ZXNbaV0gPz8gXCJcIiwgXCJcIik7XG5cbiAgICByZXR1cm4gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhodG1sLCBcInRleHQvaHRtbFwiKS5ib2R5LmNoaWxkTm9kZXNbMF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdChlOiBFdmVudCkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFJlaWZpZWQge1xuICAgIHN0YXRpYyBhY3RpdmUgPSBuZXcgU2V0PFJlaWZpZWQ+KCk7XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgcm9vdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3I8SFRNTEVsZW1lbnQ+KFwiLnJlaWZpZWQtcm9vdFwiKSE7XG5cbiAgICBhYnN0cmFjdCByZWFkb25seSBlbGVtZW50OiBIVE1MRWxlbWVudDtcblxuICAgIG1vdmUoeDogbnVtYmVyLCB5OiBudW1iZXIpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnN0eWxlLmxlZnQgPSB4ICsgXCJweFwiO1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUudG9wID0geSArIFwicHhcIjtcbiAgICB9XG5cbiAgICBhdHRhY2goKSB7XG4gICAgICAgIFJlaWZpZWQuYWN0aXZlLmFkZCh0aGlzKTtcblxuICAgICAgICBSZWlmaWVkLnJvb3QuYXBwZW5kKHRoaXMuZWxlbWVudCk7XG4gICAgfVxuXG4gICAgZGV0YWNoKCkge1xuICAgICAgICBSZWlmaWVkLmFjdGl2ZS5kZWxldGUodGhpcyk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IHVzZUNhbnZhcyB9IGZyb20gXCIuL2NhbnZhc1wiO1xuXG5leHBvcnQgY2xhc3MgV2lyaW5nIHtcbiAgICBjb25zdHJ1Y3RvcihyZWFkb25seSBmcm9tOiBFbGVtZW50LCByZWFkb25seSB0bzogRWxlbWVudCkge1xuICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICAgICAgICB0by5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZhdGVkXCIsIGZyb20uY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZhdGVkXCIpKTtcbiAgICAgICAgfSkub2JzZXJ2ZShmcm9tLCB7IGF0dHJpYnV0ZUZpbHRlcjogW1wiY2xhc3NcIl0sIGF0dHJpYnV0ZXM6IHRydWUgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgV2lyaW5nTWFuYWdlciB7XG4gICAgc3RhdGljIHdpcmVzID0gbmV3IEFycmF5PFdpcmluZz4oKTtcblxuICAgIHN0YXRpYyByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IGN0eCA9IHVzZUNhbnZhcygpO1xuXG4gICAgICAgIHRoaXMud2lyZXMuZm9yRWFjaCgod2lyZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZnJvbSA9IHdpcmUuZnJvbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHRvID0gd2lyZS50by5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gd2lyZS5mcm9tLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2YXRlZFwiKSA/IFwiI2ZmMjYyNlwiIDogXCIjZGVkZWRlXCI7XG5cbiAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSA1O1xuXG4gICAgICAgICAgICBjdHgubGluZUpvaW4gPSBcInJvdW5kXCI7XG5cbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5tb3ZlVG8oZnJvbS54ICsgZnJvbS53aWR0aCAvIDIsIGZyb20ueSArIGZyb20uaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICBjdHgubGluZVRvKHRvLnggKyB0by53aWR0aCAvIDIsIHRvLnkgKyB0by5oZWlnaHQgLyAyKTtcbiAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiY29uc3QgY3R4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImNhbnZhc1wiKSEuZ2V0Q29udGV4dChcIjJkXCIpITtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhbnZhcygpIHtcbiAgICBjdHguY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgY3R4LmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cbiAgICByZXR1cm4gY3R4O1xufVxuIiwiaW1wb3J0IHsgQm9vbGVhblR1cGxlIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENoaXA8SSBleHRlbmRzIG51bWJlciwgTyBleHRlbmRzIG51bWJlcj4ge1xuICAgIHJlYWRvbmx5IG5hbWU7XG5cbiAgICByZWFkb25seSBpbnB1dHM7XG4gICAgcmVhZG9ubHkgb3V0cHV0cztcblxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgaW5wdXRzOiBJLCBvdXRwdXRzOiBPKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuaW5wdXRzID0gaW5wdXRzO1xuICAgICAgICB0aGlzLm91dHB1dHMgPSBvdXRwdXRzO1xuICAgIH1cblxuICAgIGFic3RyYWN0IG91dHB1dChpbnB1dHM6IEJvb2xlYW5UdXBsZTxJPik6IEJvb2xlYW5UdXBsZTxPPjtcblxuICAgIGV2YWx1YXRlKGlucHV0czogYm9vbGVhbltdKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dHB1dChpbnB1dHMgYXMgQm9vbGVhblR1cGxlPEksIFtdPikgYXMgYm9vbGVhbltdO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFuZEdhdGUgZXh0ZW5kcyBDaGlwPDIsIDE+IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXCJBTkRcIiwgMiwgMSk7XG4gICAgfVxuXG4gICAgb3V0cHV0KFthLCBiXTogW2Jvb2xlYW4sIGJvb2xlYW5dKTogW2Jvb2xlYW5dIHtcbiAgICAgICAgcmV0dXJuIFthICYmIGJdO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIE9yR2F0ZSBleHRlbmRzIENoaXA8MiwgMT4ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcIk9SXCIsIDIsIDEpO1xuICAgIH1cblxuICAgIG91dHB1dChbYSwgYl06IFtib29sZWFuLCBib29sZWFuXSk6IFtib29sZWFuXSB7XG4gICAgICAgIHJldHVybiBbYSB8fCBiXTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBOb3RHYXRlIGV4dGVuZHMgQ2hpcDwxLCAxPiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiTk9UXCIsIDEsIDEpO1xuICAgIH1cblxuICAgIG91dHB1dChbbl06IFtib29sZWFuXSk6IFtib29sZWFuXSB7XG4gICAgICAgIHJldHVybiBbIW5dO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IE1lbnVNYW5hZ2VyIH0gZnJvbSBcIi4vTWVudU1hbmFnZXJcIjtcbmltcG9ydCB7IFJlaWZpZWQgfSBmcm9tIFwiLi9SZWlmaWVkXCI7XG5cbmV4cG9ydCBjb25zdCBbcXVldWVOZXdDb250ZXh0XSA9IE1lbnVNYW5hZ2VyLnVzZShSZWlmaWVkLnJvb3QsIFtcbiAgICB7XG4gICAgICAgIFwiaW5zZXJ0LWNoaXBcIjoge1xuICAgICAgICAgICAgbGFiZWw6IFwiSW5zZXJ0IGNoaXBcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7fSxcbiAgICAgICAgfSxcbiAgICB9LFxuICAgIHtcbiAgICAgICAgXCJuZXctaW5wdXRcIjoge1xuICAgICAgICAgICAgbGFiZWw6IFwiTmV3IGlucHV0XCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge30sXG4gICAgICAgIH0sXG4gICAgICAgIFwibmV3LW91dHB1dFwiOiB7XG4gICAgICAgICAgICBsYWJlbDogXCJOZXcgb3V0cHV0XCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge30sXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICAgIFwibmV3LWNoaXBcIjoge1xuICAgICAgICAgICAgbGFiZWw6IFwiTmV3IGNoaXAgZnJvbSBkaWFncmFtXCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge30sXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICAgIFwic2F2ZS1hc1wiOiB7XG4gICAgICAgICAgICBsYWJlbDogXCJTYXZlIGFzIGZpbGVcIixcbiAgICAgICAgICAgIGNhbGxiYWNrOiAoKSA9PiB7fSxcbiAgICAgICAgfSxcbiAgICAgICAgXCJpbXBvcnQtZnJvbVwiOiB7XG4gICAgICAgICAgICBsYWJlbDogXCJJbXBvcnQgZnJvbSBmaWxlXCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge30sXG4gICAgICAgIH0sXG4gICAgfSxcbl0pO1xuIiwiLy8gVGhlIG1vZHVsZSBjYWNoZVxudmFyIF9fd2VicGFja19tb2R1bGVfY2FjaGVfXyA9IHt9O1xuXG4vLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcblx0dmFyIGNhY2hlZE1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF07XG5cdGlmIChjYWNoZWRNb2R1bGUgIT09IHVuZGVmaW5lZCkge1xuXHRcdHJldHVybiBjYWNoZWRNb2R1bGUuZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSAoZXhwb3J0cykgPT4ge1xuXHRpZih0eXBlb2YgU3ltYm9sICE9PSAndW5kZWZpbmVkJyAmJiBTeW1ib2wudG9TdHJpbmdUYWcpIHtcblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgU3ltYm9sLnRvU3RyaW5nVGFnLCB7IHZhbHVlOiAnTW9kdWxlJyB9KTtcblx0fVxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgJ19fZXNNb2R1bGUnLCB7IHZhbHVlOiB0cnVlIH0pO1xufTsiLCJpbXBvcnQgeyBBbmRHYXRlIH0gZnJvbSBcIi4vY2hpcHNcIjtcbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gXCIuL0NvbXBvbmVudFwiO1xuaW1wb3J0IFwiLi9jb250ZXh0bWVudVwiO1xuaW1wb3J0IHsgRHJhZ2dpbmdNYW5hZ2VyIH0gZnJvbSBcIi4vRHJhZ2dpbmdNYW5hZ2VyXCI7XG5pbXBvcnQgeyBJbnB1dCB9IGZyb20gXCIuL0lucHV0XCI7XG5pbXBvcnQgeyBPdXRwdXQgfSBmcm9tIFwiLi9PdXRwdXRcIjtcbmltcG9ydCB7IFdpcmluZywgV2lyaW5nTWFuYWdlciB9IGZyb20gXCIuL1dpcmluZ01hbmFnZXJcIjtcblxuY29uc3QgYSA9IG5ldyBJbnB1dCh7IHg6IDEwMCwgeTogMTAwIH0pO1xuY29uc3QgYiA9IG5ldyBJbnB1dCh7IHg6IDEwMCwgeTogMjAwIH0pO1xuY29uc3QgYyA9IG5ldyBDb21wb25lbnQobmV3IEFuZEdhdGUoKSwgeyB4OiAzMDAsIHk6IDE1MCB9KTtcbmNvbnN0IGQgPSBuZXcgT3V0cHV0KHsgeDogNTAwLCB5OiAxNTAgfSk7XG5cblthLCBiLCBjLCBkXS5mb3JFYWNoKChjKSA9PiB7XG4gICAgYy5hdHRhY2goKTtcblxuICAgIGlmIChjIGluc3RhbmNlb2YgQ29tcG9uZW50KSB7XG4gICAgICAgIERyYWdnaW5nTWFuYWdlci53YXRjaChjLmVsZW1lbnQsIGMuZWxlbWVudC5xdWVyeVNlbGVjdG9yPEhUTUxFbGVtZW50PihcIi5jb21wb25lbnQtbmFtZVwiKSEpO1xuICAgIH1cbn0pO1xuXG5EcmFnZ2luZ01hbmFnZXIubGlzdGVuKCk7XG5cbldpcmluZ01hbmFnZXIud2lyZXMucHVzaChuZXcgV2lyaW5nKGEuZWxlbWVudCwgYy5pbnB1dHNbMF0pKTtcbldpcmluZ01hbmFnZXIud2lyZXMucHVzaChuZXcgV2lyaW5nKGIuZWxlbWVudCwgYy5pbnB1dHNbMV0pKTtcbldpcmluZ01hbmFnZXIud2lyZXMucHVzaChuZXcgV2lyaW5nKGMub3V0cHV0c1swXSwgZC5lbGVtZW50KSk7XG5cbihmdW5jdGlvbiBsb29wKCkge1xuICAgIFdpcmluZ01hbmFnZXIucmVuZGVyKCk7XG5cbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUobG9vcCk7XG59KSgpO1xuIl0sIm5hbWVzIjpbIkNvbXBvbmVudCIsIlJlaWZpZWQiLCJlbGVtZW50IiwiaW5wdXRzIiwib3V0cHV0cyIsIm5hbWUiLCJNYXAiLCJjaGlwIiwiY29uc3RydWN0b3IiLCJ4IiwieSIsInN1cGVyIiwidGhpcyIsImh0bWwiLCJBcnJheSIsImZpbGwiLCJqb2luIiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJxdWVyeVNlbGVjdG9yIiwiZm9yRWFjaCIsImlucHV0Iiwic2V0IiwiTXV0YXRpb25PYnNlcnZlciIsIm91dCIsImV2YWx1YXRlIiwibWFwIiwiaSIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwib3V0cHV0IiwidG9nZ2xlIiwicXVldWVOZXdDb250ZXh0IiwicHJldiIsImxhYmVsIiwiY2FsbGJhY2siLCJXaXJpbmdNYW5hZ2VyIiwid2lyZSIsInRvIiwiZGV0YWNoIiwiZXZlcnkiLCJvIiwibW92ZSIsImF0dGFjaCIsImdldCIsIm9ic2VydmUiLCJhdHRyaWJ1dGVGaWx0ZXIiLCJhdHRyaWJ1dGVzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRpc2Nvbm5lY3QiLCJsaXN0ZW5lciIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJEcmFnZ2luZ01hbmFnZXIiLCJzdGF0aWMiLCJveCIsIm95IiwiZG93biIsInRhcmdldCIsImRhdGFzZXQiLCJ3YXRjaGVkIiwibW91c2Vkb3duIiwiZSIsImRyYWdnZWQiLCJzdHlsZSIsImN1cnNvciIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJib2R5IiwicGFyZW50RWxlbWVudCIsIkRPTVJlY3QiLCJjbGllbnRYIiwibGVmdCIsImNsaWVudFkiLCJ0b3AiLCJjYXB0dXJlIiwiRXJyb3IiLCJkZWxldGUiLCJkb2N1bWVudCIsIndpbmRvdyIsInVuZGVmaW5lZCIsIklucHV0IiwiTWVudU1hbmFnZXIiLCJhY3Rpb25zIiwibWVudSIsInJlY29yZCIsIk9iamVjdCIsImVudHJpZXMiLCJjbGlja3MiLCJzZXR1cCIsImNsZWFyIiwiaW5uZXJIVE1MIiwia2V5cyIsImtleSIsImNsaWNrIiwiYmluZCIsImNvbnRleHQiLCJnZXRBY3Rpb25zIiwiZGlzcGxheSIsImFwcGVuZENoaWxkIiwiY29udGV4dG1lbnUiLCJwcmV2ZW50RGVmYXVsdCIsImxpc3RlbmVycyIsIm5ld0NvbnRleHQiLCJjYWxsIiwicmVtb3ZlIiwiT3V0cHV0IiwiYXJncyIsInRlbXBsYXRlIiwidmFsdWVzIiwicmVkdWNlIiwidGV4dCIsIkRPTVBhcnNlciIsInBhcnNlRnJvbVN0cmluZyIsImNoaWxkTm9kZXMiLCJTZXQiLCJhY3RpdmUiLCJhZGQiLCJyb290IiwiYXBwZW5kIiwiV2lyaW5nIiwiY3R4IiwidXNlQ2FudmFzIiwid2lyZXMiLCJzdHJva2VTdHlsZSIsImxpbmVXaWR0aCIsImxpbmVKb2luIiwiYmVnaW5QYXRoIiwibW92ZVRvIiwid2lkdGgiLCJoZWlnaHQiLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJnZXRDb250ZXh0IiwiY2FudmFzIiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiQ2hpcCIsIkFuZEdhdGUiLCJhIiwiYiIsIk9yR2F0ZSIsIk5vdEdhdGUiLCJuIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwiYyIsImxvb3AiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiXSwic291cmNlUm9vdCI6IiJ9