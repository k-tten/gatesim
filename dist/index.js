/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var e={"./src/Component.ts":(e,t,s)=>{s.r(t),s.d(t,{Component:()=>r});var n=s("./src/Reified.ts"),i=s("./src/WiringManager.ts");class r extends n.Reified{element;inputs;outputs;#e=new Map;#t=new Map;chip;constructor(e,{x:t,y:s}={x:0,y:0}){super(),this.chip=e,this.element=n.html`
            <div class="component">
                <div class="component-inputs">
                    ${Array(this.chip.inputs).fill('<button class="component-input-button">I</button>').join("")}
                </div>
                <p class="component-name">${this.chip.name}</p>
                <div class="component-outputs">
                    ${Array(this.chip.outputs).fill('<button class="component-output-button">O</button>').join("")}
                </div>
            </div>
        `,this.inputs=Array.from(this.element.querySelectorAll(".component-input-button")),this.outputs=Array.from(this.element.querySelectorAll(".component-output-button")),this.inputs.forEach((e=>{this.#e.set(e,new MutationObserver((()=>{const e=this.chip.evaluate(this.inputs.map((e=>e.classList.contains("activated"))));this.outputs.forEach(((t,s)=>{t.classList.toggle("activated",e[s])}))}))),this.#t.set(e,(t=>{t.preventDefault(),t.stopImmediatePropagation();const s=i.WiringManager.wires.findIndex((t=>t.to===e));s>=0&&i.WiringManager.wires.splice(s,1)}))})),this.move(t,s)}attach(){super.attach(),this.inputs.forEach((e=>{this.#e.get(e).observe(e,{attributeFilter:["class"],attributes:!0}),e.addEventListener("contextmenu",this.#t.get(e))}))}detach(){super.detach(),this.#e.forEach((e=>e.disconnect())),this.#t.forEach(((e,t)=>t.removeEventListener("contextmenu",e)))}}},"./src/DraggingManager.ts":(e,t,s)=>{s.r(t),s.d(t,{DraggingManager:()=>n});class n{static#s;static#n={x:-1,y:-1,ox:-1,oy:-1,down:!1};static#i=new Map;static watch(e,t=e){e.dataset.watched="true";const s=t=>{this.#s=e,this.#s.dataset.dragged="true",this.#s.style.cursor="grabbing";const s=this.#s.getBoundingClientRect(),n=this.#s.parentElement?.getBoundingClientRect()??new DOMRect;this.#n.ox=t.clientX-s.left+n.left,this.#n.oy=t.clientY-s.top+n.top};t.addEventListener("mousedown",s,{capture:!0}),this.#i.set(t,s)}static forget(e){const t=this.#i.get(e);if(!t)throw new Error("Element is not currently being watched.");delete e.dataset.watched,e.removeEventListener("mousedown",t,{capture:!0}),this.#i.delete(e)}static listen(){document.body.addEventListener("mousemove",this.#r),window.addEventListener("mousedown",this.#o),window.addEventListener("mouseup",this.#a)}static deafen(){document.body.removeEventListener("mousemove",this.#r),window.removeEventListener("mousedown",this.#o),window.removeEventListener("mouseup",this.#a)}static#r=e=>{this.#n.x=e.clientX,this.#n.y=e.clientY,this.#s&&(this.#s.style.left=this.#n.x-this.#n.ox+"px",this.#s.style.top=this.#n.y-this.#n.oy+"px")};static#o=e=>{this.#n.down=!0};static#a=()=>{this.#s&&document.querySelectorAll('[data-dragged="true"]').forEach((e=>{delete e.dataset.dragged,e.style.cursor=""})),this.#n.down=!1,this.#n.x=-1,this.#n.y=-1,this.#n.ox=-1,this.#n.oy=-1,this.#s=void 0}}},"./src/Input.ts":(e,t,s)=>{s.r(t),s.d(t,{Input:()=>i});var n=s("./src/Reified.ts");class i extends n.Reified{element;constructor({x:e,y:t}={x:0,y:0}){super(),this.element=n.html`<button class="board-input">I</button>`,this.move(e,t)}#c=()=>{this.element.classList.toggle("activated")};#u=e=>{e.preventDefault(),this.element.classList.toggle("activated")};attach(){super.attach(),this.element.addEventListener("click",this.#c),this.element.addEventListener("contextmenu",this.#u)}detach(){super.detach(),this.element.removeEventListener("click",this.#c),this.element.removeEventListener("contextmenu",this.#u)}}},"./src/MenuManager.ts":(e,t,s)=>{s.r(t),s.d(t,{MenuManager:()=>i});var n=s("./src/Reified.ts");class i{static#l=new Map;static use(e,t){const s=n.html`
            <div class="contextmenu">
                ${t.map((e=>Object.entries(e).map((([e,{label:t}])=>`<button class="${e}">${t}</button>`)).join(""))).join('<div class="br"></div>')}
            </div>
        `,i=new Map;t.forEach((e=>{Object.keys(e).forEach((t=>{const n=e[t].callback.bind(void 0);s.querySelector("."+t).addEventListener("click",n),s.querySelector("."+t).addEventListener("contextmenu",n),i.set(t,i)}))})),s.style.left="0px",s.style.top="0px",s.style.display="none",document.body.appendChild(s);const r=()=>{s.style.left="0px",s.style.top="0px",s.style.display="none"},o=e=>{e.preventDefault(),s.style.display="",s.style.left=e.clientX+"px",s.style.top=e.clientY+"px"},a=e=>{e.preventDefault(),s.style.left="0px",s.style.top="0px",s.style.display="none"};e.addEventListener("mousedown",r),e.addEventListener("contextmenu",o),s.addEventListener("click",a),s.addEventListener("contextmenu",a),this.#l.set(e,{menu:s,clicks:i,listeners:{mousedown:r,contextmenu:o,click:a}})}static remove(e){const{menu:t,clicks:s,listeners:n}=this.#l.get(e)??{};if(!t||!s||!n)throw new Error("Elements are not being affected.");e.removeEventListener("mousedown",n.mousedown),e.removeEventListener("contextmenu",n.contextmenu),t.removeEventListener("click",n.click),t.removeEventListener("contextmenu",n.click),Array.from(s).forEach((([e,s])=>{t.querySelector("."+e).removeEventListener("click",s),t.querySelector("."+e).removeEventListener("contextmenu",s)})),t.remove()}}},"./src/Output.ts":(e,t,s)=>{s.r(t),s.d(t,{Output:()=>r});var n=s("./src/Reified.ts"),i=s("./src/WiringManager.ts");class r extends n.Reified{element;#u=e=>{e.preventDefault(),e.stopImmediatePropagation();const t=i.WiringManager.wires.findIndex((e=>e.to===this.element));t>=0&&i.WiringManager.wires.splice(t,1)};constructor({x:e,y:t}={x:0,y:0}){super(),this.element=n.html`<button class="board-output">O</button>`,this.move(e,t)}attach(){super.attach(),this.element.addEventListener("contextmenu",this.#u)}detach(){super.detach(),this.element.removeEventListener("contextmenu",this.#u)}}},"./src/Reified.ts":(e,t,s)=>{function n(...e){const[t,...s]=e,n="string"==typeof t?t:t.reduce(((e,t,n)=>e+t+s[n]??""),"");return(new DOMParser).parseFromString(n,"text/html").body.childNodes[0]}function i(e){e.preventDefault()}s.r(t),s.d(t,{Reified:()=>r,html:()=>n,preventDefault:()=>i});class r{static root=document.querySelector(".reified-root");move(e,t){this.element.style.left=e+"px",this.element.style.top=t+"px"}attach(){r.root.append(this.element)}detach(){this.element.remove()}}},"./src/WiringManager.ts":(e,t,s)=>{s.r(t),s.d(t,{Wiring:()=>i,WiringManager:()=>r});var n=s("./src/canvas.ts");class i{from;to;constructor(e,t){this.from=e,this.to=t,new MutationObserver((()=>{t.classList.toggle("activated",e.classList.contains("activated"))})).observe(e,{attributeFilter:["class"],attributes:!0})}}class r{static wires=new Array;static render(){const e=(0,n.useCanvas)();this.wires.forEach((t=>{const s=t.from.getBoundingClientRect(),n=t.to.getBoundingClientRect();e.strokeStyle=t.from.classList.contains("activated")?"#ff2626":"#dedede",e.lineWidth=5,e.lineJoin="round",e.beginPath(),e.moveTo(s.x+s.width/2,s.y+s.height/2),e.lineTo(n.x+n.width/2,n.y+n.height/2),e.closePath(),e.stroke()}))}}},"./src/canvas.ts":(e,t,s)=>{s.r(t),s.d(t,{useCanvas:()=>i});const n=document.querySelector("canvas").getContext("2d");function i(){return n.canvas.width=window.innerWidth,n.canvas.height=window.innerHeight,n}},"./src/chips.ts":(e,t,s)=>{s.r(t),s.d(t,{AndGate:()=>i,Chip:()=>n,NotGate:()=>o,OrGate:()=>r});class n{name;inputs;outputs;constructor(e,t,s){this.name=e,this.inputs=t,this.outputs=s}evaluate(e){return this.output(e)}}class i extends n{constructor(){super("AND",2,1)}output([e,t]){return[e&&t]}}class r extends n{constructor(){super("OR",2,1)}output([e,t]){return[e||t]}}class o extends n{constructor(){super("NOT",1,1)}output([e]){return[!e]}}}},t={};function s(n){var i=t[n];if(void 0!==i)return i.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,s),r.exports}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{s.r(n);var e=s("./src/chips.ts"),t=s("./src/Component.ts"),i=s("./src/DraggingManager.ts"),r=s("./src/Input.ts"),o=s("./src/MenuManager.ts"),a=s("./src/Output.ts"),c=s("./src/Reified.ts"),u=s("./src/WiringManager.ts");const l=new r.Input({x:100,y:100}),d=new r.Input({x:100,y:200}),m=new t.Component(new e.AndGate,{x:300,y:150}),h=new a.Output({x:500,y:150}),p=new Set([l,d,m,h]);i.DraggingManager.listen(),p.forEach((e=>{e.attach(),e instanceof t.Component&&i.DraggingManager.watch(e.element,e.element.querySelector(".component-name"))})),u.WiringManager.wires.push(new u.Wiring(l.element,m.inputs[0])),u.WiringManager.wires.push(new u.Wiring(d.element,m.inputs[1])),u.WiringManager.wires.push(new u.Wiring(m.outputs[0],h.element)),o.MenuManager.use(c.Reified.root,[{"insert-chip":{label:"Insert chip",callback:()=>{}}},{"new-input":{label:"New input",callback:()=>{}},"new-output":{label:"New output",callback:()=>{}}},{"new-chip":{label:"New chip from diagram",callback:()=>{}}},{"save-as":{label:"Save as file",callback:()=>{}}}]),function e(){u.WiringManager.render(),requestAnimationFrame(e)}()})()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFBQSxJQUFnQixFQUFBOUUsUUFBQSxLQUFjLENBQzFCLENBQ0ksY0FBZSxDQUNYb0YsTUFBTyxjQUNQSyxTQUFVLFNBR2xCLENBQ0ksWUFBYSxDQUNUTCxNQUFPLFlBQ1BLLFNBQVUsUUFFZCxhQUFjLENBQ1ZMLE1BQU8sYUFDUEssU0FBVSxTQUdsQixDQUNJLFdBQVksQ0FDUkwsTUFBTyx3QkFDUEssU0FBVSxTQUdsQixDQUNJLFVBQVcsQ0FDUEwsTUFBTyxlQUNQSyxTQUFVLFdBS3RCLFNBQVVvRSxJQUNOLEVBQUEzSCxjQUFBLFNBRUE0SCxzQkFBc0JELEVBQ3pCLENBSkQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vLi9zcmMvQ29tcG9uZW50LnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9EcmFnZ2luZ01hbmFnZXIudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL0lucHV0LnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9NZW51TWFuYWdlci50cyIsIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vLi9zcmMvT3V0cHV0LnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9SZWlmaWVkLnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9XaXJpbmdNYW5hZ2VyLnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9jYW52YXMudHMiLCJ3ZWJwYWNrOi8vQGtlbHNueS9nYXRlc2ltLy4vc3JjL2NoaXBzLnRzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9Aa2Vsc255L2dhdGVzaW0vd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL0BrZWxzbnkvZ2F0ZXNpbS8uL3NyYy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDaGlwIH0gZnJvbSBcIi4vY2hpcHNcIjtcbmltcG9ydCB7IGh0bWwsIFJlaWZpZWQgfSBmcm9tIFwiLi9SZWlmaWVkXCI7XG5pbXBvcnQgeyBXaXJpbmdNYW5hZ2VyIH0gZnJvbSBcIi4vV2lyaW5nTWFuYWdlclwiO1xuXG5leHBvcnQgY2xhc3MgQ29tcG9uZW50PEkgZXh0ZW5kcyBudW1iZXIsIE8gZXh0ZW5kcyBudW1iZXI+IGV4dGVuZHMgUmVpZmllZCB7XG4gICAgcmVhZG9ubHkgZWxlbWVudDtcblxuICAgIHJlYWRvbmx5IGlucHV0cztcbiAgICByZWFkb25seSBvdXRwdXRzO1xuXG4gICAgcmVhZG9ubHkgI29ic2VydmVycyA9IG5ldyBNYXAoKTtcbiAgICByZWFkb25seSAjY29udGV4dG1lbnVzID0gbmV3IE1hcCgpO1xuXG4gICAgcmVhZG9ubHkgY2hpcDogQ2hpcDxJLCBPPjtcblxuICAgIGNvbnN0cnVjdG9yKGNoaXA6IENoaXA8SSwgTz4sIHsgeCwgeSB9OiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0gPSB7IHg6IDAsIHk6IDAgfSkge1xuICAgICAgICBzdXBlcigpO1xuXG4gICAgICAgIHRoaXMuY2hpcCA9IGNoaXA7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaHRtbGBcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21wb25lbnRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29tcG9uZW50LWlucHV0c1wiPlxuICAgICAgICAgICAgICAgICAgICAke0FycmF5KHRoaXMuY2hpcC5pbnB1dHMpLmZpbGwoJzxidXR0b24gY2xhc3M9XCJjb21wb25lbnQtaW5wdXQtYnV0dG9uXCI+STwvYnV0dG9uPicpLmpvaW4oXCJcIil9XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICAgICAgPHAgY2xhc3M9XCJjb21wb25lbnQtbmFtZVwiPiR7dGhpcy5jaGlwLm5hbWV9PC9wPlxuICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb21wb25lbnQtb3V0cHV0c1wiPlxuICAgICAgICAgICAgICAgICAgICAke0FycmF5KHRoaXMuY2hpcC5vdXRwdXRzKS5maWxsKCc8YnV0dG9uIGNsYXNzPVwiY29tcG9uZW50LW91dHB1dC1idXR0b25cIj5PPC9idXR0b24+Jykuam9pbihcIlwiKX1cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuXG4gICAgICAgIHRoaXMuaW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jb21wb25lbnQtaW5wdXQtYnV0dG9uXCIpKTtcbiAgICAgICAgdGhpcy5vdXRwdXRzID0gQXJyYXkuZnJvbSh0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5jb21wb25lbnQtb3V0cHV0LWJ1dHRvblwiKSk7XG5cbiAgICAgICAgdGhpcy5pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuI29ic2VydmVycy5zZXQoXG4gICAgICAgICAgICAgICAgaW5wdXQsXG4gICAgICAgICAgICAgICAgbmV3IE11dGF0aW9uT2JzZXJ2ZXIoKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBvdXQgPSB0aGlzLmNoaXAuZXZhbHVhdGUodGhpcy5pbnB1dHMubWFwKChpKSA9PiBpLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2YXRlZFwiKSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3V0cHV0cy5mb3JFYWNoKChvdXRwdXQsIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZhdGVkXCIsIG91dFtpXSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICB0aGlzLiNjb250ZXh0bWVudXMuc2V0KGlucHV0LCAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgIGUuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IFdpcmluZ01hbmFnZXIud2lyZXMuZmluZEluZGV4KCh3KSA9PiB3LnRvID09PSBpbnB1dCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoaW5kZXggPj0gMCkgV2lyaW5nTWFuYWdlci53aXJlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubW92ZSh4LCB5KTtcbiAgICB9XG5cbiAgICBhdHRhY2goKSB7XG4gICAgICAgIHN1cGVyLmF0dGFjaCgpO1xuXG4gICAgICAgIHRoaXMuaW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICAgICAgICB0aGlzLiNvYnNlcnZlcnMuZ2V0KGlucHV0KS5vYnNlcnZlKGlucHV0LCB7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlRmlsdGVyOiBbXCJjbGFzc1wiXSxcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzOiB0cnVlLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCB0aGlzLiNjb250ZXh0bWVudXMuZ2V0KGlucHV0KSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGRldGFjaCgpIHtcbiAgICAgICAgc3VwZXIuZGV0YWNoKCk7XG5cbiAgICAgICAgdGhpcy4jb2JzZXJ2ZXJzLmZvckVhY2goKG8pID0+IG8uZGlzY29ubmVjdCgpKTtcblxuICAgICAgICB0aGlzLiNjb250ZXh0bWVudXMuZm9yRWFjaCgobCwgaW5wdXQpID0+IGlucHV0LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBsKSk7XG4gICAgfVxufVxuIiwiZXhwb3J0IGNsYXNzIERyYWdnaW5nTWFuYWdlciB7XG4gICAgc3RhdGljICNkcmFnZ2VkOiBIVE1MRWxlbWVudCB8IHVuZGVmaW5lZDtcblxuICAgIHN0YXRpYyByZWFkb25seSAjbW91c2UgPSB7XG4gICAgICAgIHg6IC0xLFxuICAgICAgICB5OiAtMSxcbiAgICAgICAgb3g6IC0xLFxuICAgICAgICBveTogLTEsXG4gICAgICAgIGRvd246IGZhbHNlLFxuICAgIH07XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgI3dhdGNoZWQgPSBuZXcgTWFwKCk7XG5cbiAgICBzdGF0aWMgd2F0Y2goZWxlbWVudDogSFRNTEVsZW1lbnQsIHRhcmdldCA9IGVsZW1lbnQpIHtcbiAgICAgICAgZWxlbWVudC5kYXRhc2V0LndhdGNoZWQgPSBcInRydWVcIjtcblxuICAgICAgICBjb25zdCBtb3VzZWRvd24gPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgdGhpcy4jZHJhZ2dlZCA9IGVsZW1lbnQ7XG5cbiAgICAgICAgICAgIHRoaXMuI2RyYWdnZWQuZGF0YXNldC5kcmFnZ2VkID0gXCJ0cnVlXCI7XG5cbiAgICAgICAgICAgIHRoaXMuI2RyYWdnZWQuc3R5bGUuY3Vyc29yID0gXCJncmFiYmluZ1wiO1xuXG4gICAgICAgICAgICBjb25zdCByZWN0ID0gdGhpcy4jZHJhZ2dlZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAgICAgY29uc3QgYm9keSA9IHRoaXMuI2RyYWdnZWQucGFyZW50RWxlbWVudD8uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkgPz8gbmV3IERPTVJlY3QoKTtcblxuICAgICAgICAgICAgdGhpcy4jbW91c2Uub3ggPSBlLmNsaWVudFggLSByZWN0LmxlZnQgKyBib2R5LmxlZnQ7XG4gICAgICAgICAgICB0aGlzLiNtb3VzZS5veSA9IGUuY2xpZW50WSAtIHJlY3QudG9wICsgYm9keS50b3A7XG4gICAgICAgIH07XG5cbiAgICAgICAgdGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgbW91c2Vkb3duLCB7IGNhcHR1cmU6IHRydWUgfSk7XG5cbiAgICAgICAgdGhpcy4jd2F0Y2hlZC5zZXQodGFyZ2V0LCBtb3VzZWRvd24pO1xuICAgIH1cblxuICAgIHN0YXRpYyBmb3JnZXQoZWxlbWVudDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgbGlzdGVuZXIgPSB0aGlzLiN3YXRjaGVkLmdldChlbGVtZW50KTtcblxuICAgICAgICBpZiAoIWxpc3RlbmVyKSB0aHJvdyBuZXcgRXJyb3IoYEVsZW1lbnQgaXMgbm90IGN1cnJlbnRseSBiZWluZyB3YXRjaGVkLmApO1xuXG4gICAgICAgIGRlbGV0ZSBlbGVtZW50LmRhdGFzZXQud2F0Y2hlZDtcblxuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgbGlzdGVuZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcblxuICAgICAgICB0aGlzLiN3YXRjaGVkLmRlbGV0ZShlbGVtZW50KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgbGlzdGVuKCkge1xuICAgICAgICBkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZW1vdmVcIiwgdGhpcy4jbW91c2Vtb3ZlKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy4jbW91c2Vkb3duKTtcbiAgICAgICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIHRoaXMuI21vdXNldXApO1xuICAgIH1cblxuICAgIHN0YXRpYyBkZWFmZW4oKSB7XG4gICAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlbW92ZVwiLCB0aGlzLiNtb3VzZW1vdmUpO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLiNtb3VzZWRvd24pO1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgdGhpcy4jbW91c2V1cCk7XG4gICAgfVxuXG4gICAgc3RhdGljIHJlYWRvbmx5ICNtb3VzZW1vdmUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICB0aGlzLiNtb3VzZS54ID0gZS5jbGllbnRYO1xuICAgICAgICB0aGlzLiNtb3VzZS55ID0gZS5jbGllbnRZO1xuXG4gICAgICAgIGlmICh0aGlzLiNkcmFnZ2VkKSB7XG4gICAgICAgICAgICB0aGlzLiNkcmFnZ2VkLnN0eWxlLmxlZnQgPSB0aGlzLiNtb3VzZS54IC0gdGhpcy4jbW91c2Uub3ggKyBcInB4XCI7XG4gICAgICAgICAgICB0aGlzLiNkcmFnZ2VkLnN0eWxlLnRvcCA9IHRoaXMuI21vdXNlLnkgLSB0aGlzLiNtb3VzZS5veSArIFwicHhcIjtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgI21vdXNlZG93biA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXMuI21vdXNlLmRvd24gPSB0cnVlO1xuICAgIH07XG5cbiAgICBzdGF0aWMgcmVhZG9ubHkgI21vdXNldXAgPSAoKSA9PiB7XG4gICAgICAgIGlmICh0aGlzLiNkcmFnZ2VkKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsPEhUTUxFbGVtZW50PignW2RhdGEtZHJhZ2dlZD1cInRydWVcIl0nKS5mb3JFYWNoKChlKSA9PiB7XG4gICAgICAgICAgICAgICAgZGVsZXRlIGUuZGF0YXNldC5kcmFnZ2VkO1xuXG4gICAgICAgICAgICAgICAgZS5zdHlsZS5jdXJzb3IgPSBcIlwiO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLiNtb3VzZS5kb3duID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy4jbW91c2UueCA9IC0xO1xuICAgICAgICB0aGlzLiNtb3VzZS55ID0gLTE7XG5cbiAgICAgICAgdGhpcy4jbW91c2Uub3ggPSAtMTtcbiAgICAgICAgdGhpcy4jbW91c2Uub3kgPSAtMTtcblxuICAgICAgICB0aGlzLiNkcmFnZ2VkID0gdW5kZWZpbmVkO1xuICAgIH07XG59XG4iLCJpbXBvcnQgeyBodG1sLCBSZWlmaWVkIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuXG5leHBvcnQgY2xhc3MgSW5wdXQgZXh0ZW5kcyBSZWlmaWVkIHtcbiAgICByZWFkb25seSBlbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoeyB4LCB5IH06IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSA9IHsgeDogMCwgeTogMCB9KSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaHRtbGA8YnV0dG9uIGNsYXNzPVwiYm9hcmQtaW5wdXRcIj5JPC9idXR0b24+YDtcblxuICAgICAgICB0aGlzLm1vdmUoeCwgeSk7XG4gICAgfVxuXG4gICAgcmVhZG9ubHkgI2NsaWNrID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcImFjdGl2YXRlZFwiKTtcbiAgICB9O1xuXG4gICAgcmVhZG9ubHkgI2NvbnRleHRtZW51ID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZhdGVkXCIpO1xuICAgIH07XG5cbiAgICBhdHRhY2goKSB7XG4gICAgICAgIHN1cGVyLmF0dGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy4jY2xpY2spO1xuICAgICAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG5cbiAgICBkZXRhY2goKSB7XG4gICAgICAgIHN1cGVyLmRldGFjaCgpO1xuXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy4jY2xpY2spO1xuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBodG1sIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuXG5leHBvcnQgdHlwZSBNZW51TWFuYWdlckNvbnRleHQgPSB7XG4gICAgbWVudTogSFRNTEVsZW1lbnQ7XG4gICAgY2xpY2tzOiBNYXA8c3RyaW5nLCAoKSA9PiB2b2lkPjtcbiAgICBsaXN0ZW5lcnM6IHtcbiAgICAgICAgbW91c2Vkb3duOiAoZTogTW91c2VFdmVudCkgPT4gdm9pZDtcbiAgICAgICAgY29udGV4dG1lbnU6IChlOiBNb3VzZUV2ZW50KSA9PiB2b2lkO1xuICAgICAgICBjbGljazogKGU6IE1vdXNlRXZlbnQpID0+IHZvaWQ7XG4gICAgfTtcbn07XG5cbmV4cG9ydCBjbGFzcyBNZW51TWFuYWdlciB7XG4gICAgc3RhdGljIHJlYWRvbmx5ICNlbGVtZW50cyA9IG5ldyBNYXA8SFRNTEVsZW1lbnQsIE1lbnVNYW5hZ2VyQ29udGV4dD4oKTtcblxuICAgIHN0YXRpYyB1c2UoXG4gICAgICAgIGVsZW1lbnQ6IEhUTUxFbGVtZW50LFxuICAgICAgICBhY3Rpb25zOiBBcnJheTxSZWNvcmQ8c3RyaW5nLCB7IGxhYmVsOiBzdHJpbmc7IGNhbGxiYWNrOiAoZTogTW91c2VFdmVudCkgPT4gdm9pZCB9Pj5cbiAgICApIHtcbiAgICAgICAgY29uc3QgbWVudSA9IGh0bWxgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udGV4dG1lbnVcIj5cbiAgICAgICAgICAgICAgICAke2FjdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgLm1hcCgocmVjb3JkKSA9PlxuICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmVudHJpZXMocmVjb3JkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5tYXAoKFtuYW1lLCB7IGxhYmVsIH1dKSA9PiBgPGJ1dHRvbiBjbGFzcz1cIiR7bmFtZX1cIj4ke2xhYmVsfTwvYnV0dG9uPmApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmpvaW4oXCJcIilcbiAgICAgICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgICAgICAuam9pbignPGRpdiBjbGFzcz1cImJyXCI+PC9kaXY+Jyl9XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICBjb25zdCBjbGlja3MgPSBuZXcgTWFwKCk7XG5cbiAgICAgICAgYWN0aW9ucy5mb3JFYWNoKChyZWNvcmQpID0+IHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHJlY29yZCkuZm9yRWFjaCgoa2V5KSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xpY2sgPSByZWNvcmRba2V5XS5jYWxsYmFjay5iaW5kKHVuZGVmaW5lZCk7XG5cbiAgICAgICAgICAgICAgICBtZW51LnF1ZXJ5U2VsZWN0b3I8SFRNTEVsZW1lbnQ+KFwiLlwiICsga2V5KSEuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGNsaWNrKTtcbiAgICAgICAgICAgICAgICBtZW51LnF1ZXJ5U2VsZWN0b3I8SFRNTEVsZW1lbnQ+KFwiLlwiICsga2V5KSEuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGNsaWNrKTtcblxuICAgICAgICAgICAgICAgIGNsaWNrcy5zZXQoa2V5LCBjbGlja3MpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIG1lbnUuc3R5bGUubGVmdCA9IFwiMHB4XCI7XG4gICAgICAgIG1lbnUuc3R5bGUudG9wID0gXCIwcHhcIjtcbiAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cbiAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChtZW51KTtcblxuICAgICAgICBjb25zdCBtb3VzZWRvd24gPSAoKSA9PiB7XG4gICAgICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY29udGV4dG1lbnUgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBtZW51LnN0eWxlLmRpc3BsYXkgPSBcIlwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5sZWZ0ID0gZS5jbGllbnRYICsgXCJweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBlLmNsaWVudFkgKyBcInB4XCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgY2xpY2sgPSAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgICAgICBtZW51LnN0eWxlLmxlZnQgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS50b3AgPSBcIjBweFwiO1xuICAgICAgICAgICAgbWVudS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH07XG5cbiAgICAgICAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIG1vdXNlZG93bik7XG4gICAgICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIGNvbnRleHRtZW51KTtcbiAgICAgICAgbWVudS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xpY2spO1xuICAgICAgICBtZW51LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBjbGljayk7XG5cbiAgICAgICAgdGhpcy4jZWxlbWVudHMuc2V0KGVsZW1lbnQsIHsgbWVudSwgY2xpY2tzLCBsaXN0ZW5lcnM6IHsgbW91c2Vkb3duLCBjb250ZXh0bWVudSwgY2xpY2sgfSB9KTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcmVtb3ZlKGVsZW1lbnQ6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIGNvbnN0IHsgbWVudSwgY2xpY2tzLCBsaXN0ZW5lcnMgfSA9IHRoaXMuI2VsZW1lbnRzLmdldChlbGVtZW50KSA/PyB7fTtcblxuICAgICAgICBpZiAoIW1lbnUgfHwgIWNsaWNrcyB8fCAhbGlzdGVuZXJzKSB0aHJvdyBuZXcgRXJyb3IoYEVsZW1lbnRzIGFyZSBub3QgYmVpbmcgYWZmZWN0ZWQuYCk7XG5cbiAgICAgICAgZWxlbWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGxpc3RlbmVycy5tb3VzZWRvd24pO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBsaXN0ZW5lcnMuY29udGV4dG1lbnUpO1xuICAgICAgICBtZW51LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBsaXN0ZW5lcnMuY2xpY2spO1xuICAgICAgICBtZW51LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBsaXN0ZW5lcnMuY2xpY2spO1xuXG4gICAgICAgIEFycmF5LmZyb20oY2xpY2tzKS5mb3JFYWNoKChba2V5LCBsaXN0ZW5lcl0pID0+IHtcbiAgICAgICAgICAgIG1lbnUucXVlcnlTZWxlY3RvcihcIi5cIiArIGtleSkhLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBsaXN0ZW5lcik7XG4gICAgICAgICAgICBtZW51LnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyBrZXkpIS5yZW1vdmVFdmVudExpc3RlbmVyKFwiY29udGV4dG1lbnVcIiwgbGlzdGVuZXIpO1xuICAgICAgICB9KTtcblxuICAgICAgICBtZW51LnJlbW92ZSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IGh0bWwsIFJlaWZpZWQgfSBmcm9tIFwiLi9SZWlmaWVkXCI7XG5pbXBvcnQgeyBXaXJpbmdNYW5hZ2VyIH0gZnJvbSBcIi4vV2lyaW5nTWFuYWdlclwiO1xuXG5leHBvcnQgY2xhc3MgT3V0cHV0IGV4dGVuZHMgUmVpZmllZCB7XG4gICAgcmVhZG9ubHkgZWxlbWVudDtcblxuICAgIHJlYWRvbmx5ICNjb250ZXh0bWVudSA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICBlLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpO1xuXG4gICAgICAgIGNvbnN0IGluZGV4ID0gV2lyaW5nTWFuYWdlci53aXJlcy5maW5kSW5kZXgoKHcpID0+IHcudG8gPT09IHRoaXMuZWxlbWVudCk7XG5cbiAgICAgICAgaWYgKGluZGV4ID49IDApIFdpcmluZ01hbmFnZXIud2lyZXMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICB9O1xuXG4gICAgY29uc3RydWN0b3IoeyB4LCB5IH06IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSA9IHsgeDogMCwgeTogMCB9KSB7XG4gICAgICAgIHN1cGVyKCk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50ID0gaHRtbGA8YnV0dG9uIGNsYXNzPVwiYm9hcmQtb3V0cHV0XCI+TzwvYnV0dG9uPmA7XG5cbiAgICAgICAgdGhpcy5tb3ZlKHgsIHkpO1xuICAgIH1cblxuICAgIGF0dGFjaCgpIHtcbiAgICAgICAgc3VwZXIuYXR0YWNoKCk7XG5cbiAgICAgICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCB0aGlzLiNjb250ZXh0bWVudSk7XG4gICAgfVxuXG4gICAgZGV0YWNoKCkge1xuICAgICAgICBzdXBlci5kZXRhY2goKTtcblxuICAgICAgICB0aGlzLmVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNvbnRleHRtZW51XCIsIHRoaXMuI2NvbnRleHRtZW51KTtcbiAgICB9XG59XG4iLCJleHBvcnQgZnVuY3Rpb24gaHRtbCh0ZW1wbGF0ZTogVGVtcGxhdGVTdHJpbmdzQXJyYXksIC4uLnZhbHVlczogdW5rbm93bltdKTogSFRNTEVsZW1lbnQ7XG5leHBvcnQgZnVuY3Rpb24gaHRtbChodG1sOiBzdHJpbmcpOiBIVE1MRWxlbWVudDtcbmV4cG9ydCBmdW5jdGlvbiBodG1sKC4uLmFyZ3M6IFtzdHJpbmddIHwgW1RlbXBsYXRlU3RyaW5nc0FycmF5LCAuLi51bmtub3duW11dKSB7XG4gICAgY29uc3QgW3RlbXBsYXRlLCAuLi52YWx1ZXNdID0gYXJncztcblxuICAgIGNvbnN0IGh0bWwgPVxuICAgICAgICB0eXBlb2YgdGVtcGxhdGUgPT09IFwic3RyaW5nXCIgPyB0ZW1wbGF0ZSA6IHRlbXBsYXRlLnJlZHVjZSgoaHRtbCwgdGV4dCwgaSkgPT4gaHRtbCArIHRleHQgKyB2YWx1ZXNbaV0gPz8gXCJcIiwgXCJcIik7XG5cbiAgICByZXR1cm4gbmV3IERPTVBhcnNlcigpLnBhcnNlRnJvbVN0cmluZyhodG1sLCBcInRleHQvaHRtbFwiKS5ib2R5LmNoaWxkTm9kZXNbMF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdChlOiBFdmVudCkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFJlaWZpZWQge1xuICAgIHN0YXRpYyByZWFkb25seSByb290ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcjxIVE1MRWxlbWVudD4oXCIucmVpZmllZC1yb290XCIpITtcblxuICAgIGFic3RyYWN0IHJlYWRvbmx5IGVsZW1lbnQ6IEhUTUxFbGVtZW50O1xuXG4gICAgbW92ZSh4OiBudW1iZXIsIHk6IG51bWJlcikge1xuICAgICAgICB0aGlzLmVsZW1lbnQuc3R5bGUubGVmdCA9IHggKyBcInB4XCI7XG4gICAgICAgIHRoaXMuZWxlbWVudC5zdHlsZS50b3AgPSB5ICsgXCJweFwiO1xuICAgIH1cblxuICAgIGF0dGFjaCgpIHtcbiAgICAgICAgUmVpZmllZC5yb290LmFwcGVuZCh0aGlzLmVsZW1lbnQpO1xuICAgIH1cblxuICAgIGRldGFjaCgpIHtcbiAgICAgICAgdGhpcy5lbGVtZW50LnJlbW92ZSgpO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IHVzZUNhbnZhcyB9IGZyb20gXCIuL2NhbnZhc1wiO1xuXG5leHBvcnQgY2xhc3MgV2lyaW5nIHtcbiAgICBjb25zdHJ1Y3RvcihyZWFkb25seSBmcm9tOiBFbGVtZW50LCByZWFkb25seSB0bzogRWxlbWVudCkge1xuICAgICAgICBuZXcgTXV0YXRpb25PYnNlcnZlcigoKSA9PiB7XG4gICAgICAgICAgICB0by5jbGFzc0xpc3QudG9nZ2xlKFwiYWN0aXZhdGVkXCIsIGZyb20uY2xhc3NMaXN0LmNvbnRhaW5zKFwiYWN0aXZhdGVkXCIpKTtcbiAgICAgICAgfSkub2JzZXJ2ZShmcm9tLCB7IGF0dHJpYnV0ZUZpbHRlcjogW1wiY2xhc3NcIl0sIGF0dHJpYnV0ZXM6IHRydWUgfSk7XG4gICAgfVxufVxuXG5leHBvcnQgY2xhc3MgV2lyaW5nTWFuYWdlciB7XG4gICAgc3RhdGljIHdpcmVzID0gbmV3IEFycmF5PFdpcmluZz4oKTtcblxuICAgIHN0YXRpYyByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IGN0eCA9IHVzZUNhbnZhcygpO1xuXG4gICAgICAgIHRoaXMud2lyZXMuZm9yRWFjaCgod2lyZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZnJvbSA9IHdpcmUuZnJvbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgICAgIGNvbnN0IHRvID0gd2lyZS50by5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICAgICAgY3R4LnN0cm9rZVN0eWxlID0gd2lyZS5mcm9tLmNsYXNzTGlzdC5jb250YWlucyhcImFjdGl2YXRlZFwiKSA/IFwiI2ZmMjYyNlwiIDogXCIjZGVkZWRlXCI7XG5cbiAgICAgICAgICAgIGN0eC5saW5lV2lkdGggPSA1O1xuXG4gICAgICAgICAgICBjdHgubGluZUpvaW4gPSBcInJvdW5kXCI7XG5cbiAgICAgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5tb3ZlVG8oZnJvbS54ICsgZnJvbS53aWR0aCAvIDIsIGZyb20ueSArIGZyb20uaGVpZ2h0IC8gMik7XG4gICAgICAgICAgICBjdHgubGluZVRvKHRvLnggKyB0by53aWR0aCAvIDIsIHRvLnkgKyB0by5oZWlnaHQgLyAyKTtcbiAgICAgICAgICAgIGN0eC5jbG9zZVBhdGgoKTtcbiAgICAgICAgICAgIGN0eC5zdHJva2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiY29uc3QgY3R4ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImNhbnZhc1wiKSEuZ2V0Q29udGV4dChcIjJkXCIpITtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUNhbnZhcygpIHtcbiAgICBjdHguY2FudmFzLndpZHRoID0gd2luZG93LmlubmVyV2lkdGg7XG4gICAgY3R4LmNhbnZhcy5oZWlnaHQgPSB3aW5kb3cuaW5uZXJIZWlnaHQ7XG5cbiAgICByZXR1cm4gY3R4O1xufVxuIiwiaW1wb3J0IHsgQm9vbGVhblR1cGxlIH0gZnJvbSBcIi4vdHlwZXNcIjtcblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENoaXA8SSBleHRlbmRzIG51bWJlciwgTyBleHRlbmRzIG51bWJlcj4ge1xuICAgIHJlYWRvbmx5IG5hbWU7XG5cbiAgICByZWFkb25seSBpbnB1dHM7XG4gICAgcmVhZG9ubHkgb3V0cHV0cztcblxuICAgIGNvbnN0cnVjdG9yKG5hbWU6IHN0cmluZywgaW5wdXRzOiBJLCBvdXRwdXRzOiBPKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuaW5wdXRzID0gaW5wdXRzO1xuICAgICAgICB0aGlzLm91dHB1dHMgPSBvdXRwdXRzO1xuICAgIH1cblxuICAgIGFic3RyYWN0IG91dHB1dChpbnB1dHM6IEJvb2xlYW5UdXBsZTxJPik6IEJvb2xlYW5UdXBsZTxPPjtcblxuICAgIGV2YWx1YXRlKGlucHV0czogYm9vbGVhbltdKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm91dHB1dChpbnB1dHMgYXMgQm9vbGVhblR1cGxlPEksIFtdPikgYXMgYm9vbGVhbltdO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIEFuZEdhdGUgZXh0ZW5kcyBDaGlwPDIsIDE+IHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgc3VwZXIoXCJBTkRcIiwgMiwgMSk7XG4gICAgfVxuXG4gICAgb3V0cHV0KFthLCBiXTogW2Jvb2xlYW4sIGJvb2xlYW5dKTogW2Jvb2xlYW5dIHtcbiAgICAgICAgcmV0dXJuIFthICYmIGJdO1xuICAgIH1cbn1cblxuZXhwb3J0IGNsYXNzIE9yR2F0ZSBleHRlbmRzIENoaXA8MiwgMT4ge1xuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICBzdXBlcihcIk9SXCIsIDIsIDEpO1xuICAgIH1cblxuICAgIG91dHB1dChbYSwgYl06IFtib29sZWFuLCBib29sZWFuXSk6IFtib29sZWFuXSB7XG4gICAgICAgIHJldHVybiBbYSB8fCBiXTtcbiAgICB9XG59XG5cbmV4cG9ydCBjbGFzcyBOb3RHYXRlIGV4dGVuZHMgQ2hpcDwxLCAxPiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHN1cGVyKFwiTk9UXCIsIDEsIDEpO1xuICAgIH1cblxuICAgIG91dHB1dChbbl06IFtib29sZWFuXSk6IFtib29sZWFuXSB7XG4gICAgICAgIHJldHVybiBbIW5dO1xuICAgIH1cbn1cbiIsIi8vIFRoZSBtb2R1bGUgY2FjaGVcbnZhciBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX18gPSB7fTtcblxuLy8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbmZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG5cdHZhciBjYWNoZWRNb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdO1xuXHRpZiAoY2FjaGVkTW9kdWxlICE9PSB1bmRlZmluZWQpIHtcblx0XHRyZXR1cm4gY2FjaGVkTW9kdWxlLmV4cG9ydHM7XG5cdH1cblx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcblx0dmFyIG1vZHVsZSA9IF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0gPSB7XG5cdFx0Ly8gbm8gbW9kdWxlLmlkIG5lZWRlZFxuXHRcdC8vIG5vIG1vZHVsZS5sb2FkZWQgbmVlZGVkXG5cdFx0ZXhwb3J0czoge31cblx0fTtcblxuXHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cblx0X193ZWJwYWNrX21vZHVsZXNfX1ttb2R1bGVJZF0obW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cblx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcblx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xufVxuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiaW1wb3J0IHsgQW5kR2F0ZSB9IGZyb20gXCIuL2NoaXBzXCI7XG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tIFwiLi9Db21wb25lbnRcIjtcbmltcG9ydCB7IERyYWdnaW5nTWFuYWdlciB9IGZyb20gXCIuL0RyYWdnaW5nTWFuYWdlclwiO1xuaW1wb3J0IHsgSW5wdXQgfSBmcm9tIFwiLi9JbnB1dFwiO1xuaW1wb3J0IHsgTWVudU1hbmFnZXIgfSBmcm9tIFwiLi9NZW51TWFuYWdlclwiO1xuaW1wb3J0IHsgT3V0cHV0IH0gZnJvbSBcIi4vT3V0cHV0XCI7XG5pbXBvcnQgeyBSZWlmaWVkIH0gZnJvbSBcIi4vUmVpZmllZFwiO1xuaW1wb3J0IHsgV2lyaW5nLCBXaXJpbmdNYW5hZ2VyIH0gZnJvbSBcIi4vV2lyaW5nTWFuYWdlclwiO1xuXG5jb25zdCBhID0gbmV3IElucHV0KHsgeDogMTAwLCB5OiAxMDAgfSk7XG5jb25zdCBiID0gbmV3IElucHV0KHsgeDogMTAwLCB5OiAyMDAgfSk7XG5jb25zdCBjID0gbmV3IENvbXBvbmVudChuZXcgQW5kR2F0ZSgpLCB7IHg6IDMwMCwgeTogMTUwIH0pO1xuY29uc3QgZCA9IG5ldyBPdXRwdXQoeyB4OiA1MDAsIHk6IDE1MCB9KTtcblxuY29uc3QgYWN0aXZlID0gbmV3IFNldChbYSwgYiwgYywgZF0pO1xuXG5EcmFnZ2luZ01hbmFnZXIubGlzdGVuKCk7XG5cbmFjdGl2ZS5mb3JFYWNoKChjKSA9PiB7XG4gICAgYy5hdHRhY2goKTtcblxuICAgIGlmIChjIGluc3RhbmNlb2YgQ29tcG9uZW50KSB7XG4gICAgICAgIERyYWdnaW5nTWFuYWdlci53YXRjaChjLmVsZW1lbnQsIGMuZWxlbWVudC5xdWVyeVNlbGVjdG9yPEhUTUxFbGVtZW50PihcIi5jb21wb25lbnQtbmFtZVwiKSEpO1xuICAgIH1cbn0pO1xuXG5XaXJpbmdNYW5hZ2VyLndpcmVzLnB1c2gobmV3IFdpcmluZyhhLmVsZW1lbnQsIGMuaW5wdXRzWzBdKSk7XG5XaXJpbmdNYW5hZ2VyLndpcmVzLnB1c2gobmV3IFdpcmluZyhiLmVsZW1lbnQsIGMuaW5wdXRzWzFdKSk7XG5XaXJpbmdNYW5hZ2VyLndpcmVzLnB1c2gobmV3IFdpcmluZyhjLm91dHB1dHNbMF0sIGQuZWxlbWVudCkpO1xuXG5NZW51TWFuYWdlci51c2UoUmVpZmllZC5yb290LCBbXG4gICAge1xuICAgICAgICBcImluc2VydC1jaGlwXCI6IHtcbiAgICAgICAgICAgIGxhYmVsOiBcIkluc2VydCBjaGlwXCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge30sXG4gICAgICAgIH0sXG4gICAgfSxcbiAgICB7XG4gICAgICAgIFwibmV3LWlucHV0XCI6IHtcbiAgICAgICAgICAgIGxhYmVsOiBcIk5ldyBpbnB1dFwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHt9LFxuICAgICAgICB9LFxuICAgICAgICBcIm5ldy1vdXRwdXRcIjoge1xuICAgICAgICAgICAgbGFiZWw6IFwiTmV3IG91dHB1dFwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHt9LFxuICAgICAgICB9LFxuICAgIH0sXG4gICAge1xuICAgICAgICBcIm5ldy1jaGlwXCI6IHtcbiAgICAgICAgICAgIGxhYmVsOiBcIk5ldyBjaGlwIGZyb20gZGlhZ3JhbVwiLFxuICAgICAgICAgICAgY2FsbGJhY2s6ICgpID0+IHt9LFxuICAgICAgICB9LFxuICAgIH0sXG4gICAge1xuICAgICAgICBcInNhdmUtYXNcIjoge1xuICAgICAgICAgICAgbGFiZWw6IFwiU2F2ZSBhcyBmaWxlXCIsXG4gICAgICAgICAgICBjYWxsYmFjazogKCkgPT4ge30sXG4gICAgICAgIH0sXG4gICAgfSxcbl0pO1xuXG4oZnVuY3Rpb24gbG9vcCgpIHtcbiAgICBXaXJpbmdNYW5hZ2VyLnJlbmRlcigpO1xuXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGxvb3ApO1xufSkoKTtcbiJdLCJuYW1lcyI6WyJDb21wb25lbnQiLCJSZWlmaWVkIiwiZWxlbWVudCIsImlucHV0cyIsIm91dHB1dHMiLCJNYXAiLCJjaGlwIiwiY29uc3RydWN0b3IiLCJ4IiwieSIsInN1cGVyIiwidGhpcyIsImh0bWwiLCJBcnJheSIsImZpbGwiLCJqb2luIiwibmFtZSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImlucHV0Iiwic2V0IiwiTXV0YXRpb25PYnNlcnZlciIsIm91dCIsImV2YWx1YXRlIiwibWFwIiwiaSIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwib3V0cHV0IiwidG9nZ2xlIiwiZSIsInByZXZlbnREZWZhdWx0Iiwic3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIiwiaW5kZXgiLCJXaXJpbmdNYW5hZ2VyIiwidyIsInRvIiwibW92ZSIsImF0dGFjaCIsImdldCIsIm9ic2VydmUiLCJhdHRyaWJ1dGVGaWx0ZXIiLCJhdHRyaWJ1dGVzIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRldGFjaCIsIm8iLCJkaXNjb25uZWN0IiwibCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJEcmFnZ2luZ01hbmFnZXIiLCJzdGF0aWMiLCJveCIsIm95IiwiZG93biIsInRhcmdldCIsImRhdGFzZXQiLCJ3YXRjaGVkIiwibW91c2Vkb3duIiwiZHJhZ2dlZCIsInN0eWxlIiwiY3Vyc29yIiwicmVjdCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsImJvZHkiLCJwYXJlbnRFbGVtZW50IiwiRE9NUmVjdCIsImNsaWVudFgiLCJsZWZ0IiwiY2xpZW50WSIsInRvcCIsImNhcHR1cmUiLCJsaXN0ZW5lciIsIkVycm9yIiwiZGVsZXRlIiwiZG9jdW1lbnQiLCJ3aW5kb3ciLCJ1bmRlZmluZWQiLCJJbnB1dCIsIk1lbnVNYW5hZ2VyIiwiYWN0aW9ucyIsIm1lbnUiLCJyZWNvcmQiLCJPYmplY3QiLCJlbnRyaWVzIiwibGFiZWwiLCJjbGlja3MiLCJrZXlzIiwia2V5IiwiY2xpY2siLCJjYWxsYmFjayIsImJpbmQiLCJxdWVyeVNlbGVjdG9yIiwiZGlzcGxheSIsImFwcGVuZENoaWxkIiwiY29udGV4dG1lbnUiLCJsaXN0ZW5lcnMiLCJyZW1vdmUiLCJPdXRwdXQiLCJhcmdzIiwidGVtcGxhdGUiLCJ2YWx1ZXMiLCJyZWR1Y2UiLCJ0ZXh0IiwiRE9NUGFyc2VyIiwicGFyc2VGcm9tU3RyaW5nIiwiY2hpbGROb2RlcyIsInJvb3QiLCJhcHBlbmQiLCJXaXJpbmciLCJjdHgiLCJ1c2VDYW52YXMiLCJ3aXJlcyIsIndpcmUiLCJzdHJva2VTdHlsZSIsImxpbmVXaWR0aCIsImxpbmVKb2luIiwiYmVnaW5QYXRoIiwibW92ZVRvIiwid2lkdGgiLCJoZWlnaHQiLCJsaW5lVG8iLCJjbG9zZVBhdGgiLCJzdHJva2UiLCJnZXRDb250ZXh0IiwiY2FudmFzIiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwiQ2hpcCIsIkFuZEdhdGUiLCJhIiwiYiIsIk9yR2F0ZSIsIk5vdEdhdGUiLCJuIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJkIiwiZGVmaW5pdGlvbiIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJyIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsImMiLCJhY3RpdmUiLCJTZXQiLCJsb29wIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==